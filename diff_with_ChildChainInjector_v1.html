<!DOCTYPE html>
<!-- ExamDiff Pro HTML Template Version: 2.0 -->
<!-- Copyright (C) 1997-2023 PrestoSoft LLC -->
<!-- Generated by ExamDiff Pro build 15.0.1.2 -->
<!-- saved from url=(0014)about:internet -->
<html>

<head>
    <title>ExamDiff Pro Diff Report</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,700" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:300,400,700" rel="stylesheet">
    <style type="text/css">
        /* Test element for CSS calc() function*/
        #css3-calc {
            width: 10px;
            width: calc(10px + 10px);
            display: none;
        }

        html {
            background-color: #FFFFFF;
        }

        body {
            margin: 0;
            padding: 0;
            background-color: #FFFFFF;
            color: #000000;
            font-family: Consolas, monospace;
            font-size: 11px;
            font-style: normal;
            font-weight: 400;
        }

        table td, table th {
            padding: 0;
        }

        .error {
            font-size: 24px;
            margin: 20px;
            font-family: "Roboto", "Helvetica", "Arial", sans-serif;
        }

        #container {
            width: calc(100% - 20px);
            padding: 10px;
            border-radius: 5px;
            -moz-border-radius: 5px;
            -webkit-border-radius: 5px;
            -khtml-border-radius: 5px;
        }

        .pane {
            float: left;
            margin: 10px 0 10px 10px;
            box-shadow: 0 3px 6px rgba(0,0,0,0.16), 0 3px 6px rgba(0,0,0,0.23);
        }

        #navigation {
            width: 100%;
            table-layout: fixed;
            border-spacing: 0;
        }

        #currentDiff {
            width: calc(100% - 20px);
            margin: 0 10px;
            font-family: 'Roboto', sans-serif;
        }

        #diff-select {
            padding: 4px 0;
            border-radius: 3px;
            margin-left: 10px;
            box-shadow: 0 1px 4px rgba(0, 0, 0, .6);
        }

        .title {
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            color: #454545;
            font-size: 13px;
            font-weight: 700;
            font-family: "Roboto", "Helvetica", "Arial", sans-serif;
            padding: 6px;
            position: relative;
            z-index: 1;
            margin-bottom: 4px;
            box-shadow: 0 2px 4px -1px rgba(0, 0, 0, 0.5);
        }

        .file {
            overflow: auto;
            position: relative;
            z-index: 0;
        }

        .panes {
            border-spacing: 0;
            border-collapse: collapse;
        }

        .content {
            width: 100%;
        }

        .content div {
            min-width: 100%;
        }

        .header {
            background-color: #F0F0F0;
            height: 17px;
            border-bottom: 1px solid #999;
            color: #444;
            display: flex;
        }

        .resize-divider {
            width: 3px;
            padding: 0 1px !important;
            height: 100%;
            cursor: ew-resize;
        }

        .resize-divider-line {
            padding: 0 !important;
            width: 1px;
            height: 100%;
            background-color: #999999;
        }

        .diffBar {
            vertical-align: top;
            width: 6px;
            min-width: 6px;
            background-color: #eee;
        }

        .diffs {
            position: relative;
        }

        .diff {
            position: absolute;
            left: -3px;
            min-width: 9px;
            background-color: #C0C0C0;
            border-top: 1px solid #AAA;
            border-bottom: 1px solid #AAA;
            box-sizing: border-box;
        }

        .diff.active {
            background-color: yellow;
            z-index: 1;
        }

        .hd {
            display: none;
        }
        
        .nums {
            float: left;
        }

        .num {
            display: block;
            height: 13px;
            text-align: right;
            padding-left: 2px;
            padding-right: 4px;
            border-right: 0 !important;
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            -webkit-transform: translateZ(0);
            -khtml-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }

        #legend {
            height: 13px;
            clear: both;
            padding-top: 3px;
            padding-bottom: 15px;
            font-family: 'Roboto', sans-serif;
        }

        #legend #numDiffs {
            float: left;
            margin-left: 3px;
        }

        #legend #colors {
            float: right;
            margin-left: 1em;
        }

        #legend #colors div {
            float: left;
            margin-right: 1em;
            padding: 5px 8px;
            border-radius: 15px;
        }

        #legend #colors div:last-child {
            margin-right: 0;
        }

        #inspector {
            clear: both;
            margin: 5px 0 10px 0;
            position: relative;
            top: 2px;
            overflow: auto;
            box-shadow: 0 3px 6px rgba(0,0,0,0.16), 0 3px 6px rgba(0,0,0,0.23);
            overflow-y: hidden;
        }

        #inspector .content div {
            width: 100%;
        }

        #inspector .lib, #inspector .lab, #inspector .ldb, #inspector .lcb, #inspector .lnb, #inspector .lob, #inspector .lgb {
            border: 0;
        }

        .inspectorLine {
            border-spacing: 0 1px;
        }

        #inspectorLeft {
            border-bottom: 1px dotted #444;
        }

        #generated_by {
            text-align: right;
            font-size: 0.7rem;
            font-family: Arial;
            color: #888;
            padding-top: 1px;
        }

        #generated_by a {
            color: #888;
        }

        .li, .la, .ld, .lc, .ln, .lo, .lg, .lh {
            position: relative;
            height: 13px;
            line-height: 13px;
            box-sizing: border-box;
            white-space:pre;;
        }

        .lib, .lab, .ldb, .lcb, .lnb, .lob, .lgb {
            position: absolute;
            bottom: 0px;
            height: 1px;
            border-bottom: 1px solid #989898;
        }

        .lbin {
            white-space: pre;
            color: #000000;
            background-color: #FFFFFF;
            height: 13px;
        }

        .li, .si {
            color: #000000;
            background-color: #FFFFFF;
            text-decoration: none;
        }

        .la, .sa {
            color: #880E4F;
            background-color: #BDBDBD;
            text-decoration: none;
        }

        .ld, .sd {
            color: #0126F8;
            background-color: #E0E0E0;
            text-decoration: none;
        }

        .lc, .sc {
            color: #004D40;
            background-color: #FFF9C4;
            text-decoration: none;
        }

        .ln, .sn {
            color: #9C27B0;
            background-color: #B3E5FC;
            text-decoration: none;
        }

        .lo, .so {
            color: #D32F2F;
            background-color: #C8E6C9;
            text-decoration: none;
        }

        .lg, .sig {
            color: #2E7D32;
            background-color: #EEEEEE;
            text-decoration: none;
        }

        .sc2 {
            color: #E040FB;
            background-color: #B3E5FC;
            text-decoration: none;
        }

        .lh {
            font-weight: 700;
            color: $GROUP_COLOR$;
            display: inline-block;
            position: relative;
            white-space: nowrap;
        }

        .lh:before {
            position: absolute;
            display: block;
            top: 0;
            left: 0;
            bottom: 0;
            content: attr(data-content);
            background-color: #FFFFFF;
            color: #FFFFFF;
            z-index: -1;
            padding-right: .5em;
        }

        .lh:after {
            position: absolute;
            content: '';
            display: block;
            left: 0;
            right: 0;
            top: 50%;
            background-color: $GROUP_COLOR$;
            height: 1px;
            min-height: 1px;
            z-index: -2;
        }

        .directory .content div {
            padding-left: 3px;
            box-sizing: border-box;
            min-width: unset;
        }

        .directory .content span {
            margin-right: 3px;
            box-sizing: border-box;
        }

        .directory .content span.expand-collapse-button {
            width: 24px;
            display: inline-block;
            text-align: center;
            cursor: pointer;
            margin-right: 0;
        }

        .directory .l {
            width: px;
        }

        /* ==========  Select Field ========== */

        /* Style Select Field */
        select {
            font-family: inherit;
            background-color: transparent;
            width: 100%;
            padding: 4px 0;
            font-size: 12px;
            color: #000000;
            border: none;
            border-bottom: 1px solid rgba(0, 0, 0, 0.12);
            cursor: pointer;
            appearance: none;
            -webkit-appearance: none;
            -moz-appearance: none;
            background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAA4UlEQVQ4T82TSwrCQBBEq5P7OEIynsFTqCAqHkH84AfUK4iJ4j1cunImYOJ1NC0GE9TEuMgmsxyoV1RXN6Hgo4J6lARQsWttBuRVn/sA+E8soyrlBiGdLt75EEUQUk7AmDGH28DzejkQQ9jSAdBi8CjQepnMIIYQwbko1c2ApMRP848hviBTIrhfEENYlgsymrFzHDPVgrDkGIQZwDtf687TJBEThoFSq/cZZdYoLDkCYY7wvmfTNInR4AxxKsI7+QVZRH+Mge+pdVY7uYskbPsIopuvVP1XtSXZxCIHVTjCA1kmWxGf+pdLAAAAAElFTkSuQmCC);
            background-repeat: no-repeat;
            background-position: right center;
        }

        select::-ms-expand {
            display: none;
        }

        select:hover {
            box-shadow: inset 0 -2px black;
            transition: all ease-in-out 50ms;
        }

        /* Remove focus */
        select:focus {
            outline: none;
        }

        .button {
            width: 32px;
            padding: 3px;
        }

        #tdBtnFirst {
            padding-left: 0;
        }

        .button button {
            width: 100%;
            position: relative;
            display: block;
            padding: 0;
            overflow: hidden;
            border-width: 0;
            outline: none;
            border-radius: 2px;
            box-shadow: 0 1px 4px rgba(0, 0, 0, .6);
            height: 25px;
            background-color: #EEE;
            background-repeat: no-repeat;
            background-position: center;
            color: #444;
            cursor: pointer;
            transition: background-color .3s;
        }

        .button button:hover {
            background-color: #BBB;
        }

        .button button > * {
            position: relative;
        }

        .button button span {
            display: block;
            padding: 12px 24px;
        }

        .button button:before {
            content: "";
            position: absolute;
            top: 50%;
            left: 50%;
            display: block;
            width: 0;
            padding-top: 0;
            border-radius: 100%;
            background-color: rgba(236, 240, 241, .3);
            -webkit-transform: translate(-50%, -50%);
            -moz-transform: translate(-50%, -50%);
            -ms-transform: translate(-50%, -50%);
            -o-transform: translate(-50%, -50%);
            transform: translate(-50%, -50%);
        }

        .button button:active:before {
            width: 120%;
            padding-top: 120%;
            transition: width .2s ease-out, padding-top .2s ease-out;
        }

        /* Navigation button arrows */
        #btnFirst {
            background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAA2klEQVQ4T6XTOU4DQRBG4c8RKVwCDsByCEjAuQlZHCOuQYBYRIqvYLAhs7kI4ggmgQiV1COV0MxoYDps6b36u6p6oOcZ9OS1CTbwgAu8p0JjrOEq7poEAb9iG484LoKAb/CFrRDXCQJ+wQ4WOMAnMnyIWV2C9VK5E/xb8Gc4CwKO2LtdYufJVT0IwRx7/xWENEuW2C/NO8ctvhHNe65LUN01Sc5wVyRHeKqAujFmyVtJskKWDDFtW6QsmWBUKp7iviTZbFqk/JyIfYmP9O6TssrXbQk6/7Hev/EHnWxAEQGOq7sAAAAASUVORK5CYII=);
        }

        #btnPrevious {
            background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAkElEQVQ4T7XTyQ3CMBRF0ZNWSDVQDwQ6YCgiEqUA3cCSYY0sYSlCcmwT4bXv9ZPf/42Jp5nIKxVscEX//WCJIMBb3NHiNpTkBBF+Yo5LTYI1dkjCQZZK0GGfg1OCFQ4l8N8EQTxMscA5NS9jLRRJcjVGyQshyammxng3Sh6Y1Q5SlCw/4PGXBKP7lvuD7LK+AZL8IhHkloozAAAAAElFTkSuQmCC);
        }

        #btnNext {
            background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAjklEQVQ4T7XTuQ0CMRCF4W9DQIKQdjg6IaAAoAyOYoBy6AWtRGAhjwdY4djz+x3jzsDTDZwXAbaY4pg9UAPM8cAEB5xakEjBAneMM0grgxKyx7mmJAuxhOxweYdkgP5+E/J3wPIV5ghfW1jhhnC49xdZWOOaDUeAcpGqsssmIgUbzGq1/VJj8zt8UmMT8ASLkBYRatHp6AAAAABJRU5ErkJggg==);
        }

        #btnLast {
            background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAA2ElEQVQ4T6XTO06CYRCF4YcCqWQLug2094YL0N5La+EiTNwBoqVWop0uQdyBrgJcgZnkIxnxI0D+qee8M5lzpqVhtRrqZcA1fjBI0G3c4hyT2rAZYAtf6OAyQR5xik/s1yB5g0O8YiNBNvGG3UWQ+Rsc4WUdSO2IfYxWhSxy4RjPq0CaAPYwrQHy9AvcoVuOuYNxcWQats4Dsji8HxbxO3r4wEFMnmUiA7L4DPfLxHmDCNI32iV1IY56wkmZHEGKpP6pvMFVaXhIHQG+KcH6J67dYO3favyNv9m0OhE4k2c+AAAAAElFTkSuQmCC);
        }

        .s1-90{color:#0000FF;background-color:#FFFFFF;}
.s1-89{color:#008000;background-color:#FFFFFF;}
.s1-86{color:#0000FF;background-color:#FFFFFF;}
.s1-88{color:#000000;background-color:#FFFFFF;}
.s1-87{color:#000000;background-color:#FFFFFF;}
.s1-85{color:#A31515;background-color:#FFFFFF;}
.s1-100{color:#ACA899;background-color:#FFFFFF;}
.s2-90{color:#0000FF;background-color:#FFFFFF;}
.s2-89{color:#008000;background-color:#FFFFFF;}
.s2-86{color:#0000FF;background-color:#FFFFFF;}
.s2-88{color:#000000;background-color:#FFFFFF;}
.s2-87{color:#000000;background-color:#FFFFFF;}
.s2-85{color:#A31515;background-color:#FFFFFF;}
.s2-100{color:#ACA899;background-color:#FFFFFF;}
.num{color:#808080;background-color:#F8F8F8;border-right-width:2px;border-right-style:groove;border-right-color:#E0E0E0;}

    </style>

    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js">
        
    </script>

    <script type="text/javascript">
        var $mode = 'text';
        var $orientation = 'vertical';
        var $useLineInspector = true;
        var $lineHeight = 13;
        var $scrollTimeout;
        var $diffs = [
null,
{d:'Diff 1: Change 1 line (10, first file) to 1 line (10, second file)',l:[9,9]},
{d:'Diff 2: Change 1 line (13, first file) to 1 line (14, second file)',l:[13,13]},
{d:'Diff 3: Delete 1 line (21, first file) after line 21 (second file)',l:[21,21]},
{d:'Diff 4: Change 5 lines (24 - 28, first file) to 1 line (24, second file)',l:[24,28]},
{d:'Diff 5: Change 4 lines (31 - 34, first file) to 1 line (27, second file)',l:[31,34]},
{d:'Diff 6: Change 5 lines (68 - 72, first file) to 3 lines (62 - 64, second file)',l:[69,73]},
{d:'Diff 7: Change 4 lines (89 - 92, first file) to 1 line (81, second file)',l:[90,93]},
{d:'Diff 8: Change 3 lines (157 - 159, first file) to 1 line (147, second file)',l:[159,161]},
{d:'Diff 9: Change 1 line (179, first file) to 1 line (167, second file)',l:[181,181]},
{d:'Diff 10: Add 1 line (199, second file) after line 210 (first file)',l:[213,213]},
{d:'Diff 11: Change 1 line (218, first file) to 1 line (207, second file)',l:[221,221]},
{d:'Diff 12: Change 2 lines (222 - 223, first file) to 1 line (211, second file)',l:[225,226]},
{d:'Diff 13: Change 9 lines (231 - 239, first file) to 2 lines (220 - 221, second file)',l:[235,243]},
{d:'Diff 14: Change 5 lines (241 - 245, first file) to 1 line (223, second file)',l:[245,249]},
{d:'Diff 15: Change 3 lines (268 - 270, first file) to 1 line (246, second file)',l:[272,274]},
{d:'Diff 16: Change 3 lines (287 - 289, first file) to 1 line (263, second file)',l:[291,293]},
{d:'Diff 17: Change 5 lines (325 - 329, first file) to 2 lines (301 - 302, second file)',l:[331,335]},
{d:'Diff 18: Change 6 lines (338 - 343, first file) to 2 lines (311 - 312, second file)',l:[344,349]},
{d:'Diff 19: Change 3 lines (353 - 355, first file) to 1 line (322, second file)',l:[359,361]},
{d:'Diff 20: Change 4 lines (357 - 360, first file) to 1 line (324, second file)',l:[363,366]},
{d:'Diff 21: Change 5 lines (374 - 378, first file) to 1 line (338, second file)',l:[380,384]},
{d:'Diff 22: Change 3 lines (415 - 417, first file) to 1 line (373, second file)',l:[421,423]},
{d:'Diff 23: Change 7 lines (429 - 435, first file) to 1 line (385, second file)',l:[435,441]}
];

        try {
            $(window).bind('load resize', fitToWindow);

            $(document).ready(function () {
                // Check css calc() support. We'll use it to reject older browsers.
                $('body').append('<div id="css3-calc"></div>');
                if ($('#css3-calc').width() == 10) {
                    $('body').empty().append('<div class="error">This browser does not support ExamDiff Pro HTML diff reports. Please upgrade your browser to the latest Firefox, Chrome, Microsoft Edge, or Internet Explorer.</div>');
                } else {
                    $('#css3-calc').remove(); // Remove the test element


                    initializeRowVisibilityState();
                    populateParentArrows();
                    populateDiffs();
                    firstDiff();
                    registerEventHandlers();

                    if ($useLineInspector) {
                        $('#inspector').show();
                        setLineInspector(0);
                    }
                }
            });
        } catch (e) {
            $('body').empty().append('<div class="error">This HTML diff report did not load correctly, most likely due to lack of an Internet connection.\n\nIf you wish for ExamDiff Pro diff reports to be viewed on computers without Internet access, make sure to check the "Enable offline report viewing" option under Options | HTML.</div>');
        }

        var $rowVisibilityState = [];
        var $expandedUnicodeArrow = '&#x25E2';
        var $collapsedUnicodeArrow = '&#x25B7';
        var $isDraggingMouse = false;
        var $idsBeingResized = [];

        function initializeRowVisibilityState() {
            getNonHeaderRows()
                .each(function () {
                    var isRowVisible = !$(this).attr('class').includes('hd');
                    $rowVisibilityState.push(isRowVisible);
                });
        }

        function populateParentArrows() {
            var parentRowIndices = getAllParentRowIndices();

            getNonHeaderRows().each(function () {
                if (!$(this).attr('id')) {
                    // Ignore if this is not tree mode
                    return;
                }

                var rowIndex = $(this).attr('id').split('-')[1];

                var nestingLevel = getNestingLevel(this);
                var isRowParent = parentRowIndices.includes(rowIndex);

                if (isRowParent) {
                    appendExpandCollapseButton(0, rowIndex, 'collapsed')
                    appendExpandCollapseButton(1, rowIndex, 'collapsed')

                    addPaddingForNesting(rowIndex, 0, nestingLevel - 1);
                    addPaddingForNesting(rowIndex, 1, nestingLevel - 1);
                } else {
                    addPaddingForNesting(rowIndex, 0, nestingLevel);
                    addPaddingForNesting(rowIndex, 1, nestingLevel);
                }
            });
        }

        function getRowElementByIndex(rowIndex) {
            return $('#0-' + rowIndex);
        }

        function getNestingLevel(rowElement) {
            if (!!$(rowElement).attr('data-pid')) {
                return 1 + getNestingLevel(getRowElementByIndex($(rowElement).attr('data-pid')));
            }

            return 1;
        }

        function addPaddingForNesting(rowIndex, paneIndex, nestingLevel) {
            var rowSelectorPrefix = '#' + paneIndex + '-' + rowIndex + ' .c' + (paneIndex + 1) + '_';
            $(rowSelectorPrefix + '1').css('padding-left', (24 * nestingLevel) + 'px');
        }

        function appendExpandCollapseButton(paneIndex, rowIndex, state) {
            var rowSelectorPrefix = '#' + paneIndex + '-' + rowIndex + ' .c' + (paneIndex + 1) + '_';
            var arrow = state == 'collapsed' ? $collapsedUnicodeArrow : $expandedUnicodeArrow;
            var previousState = state == 'collapsed' ? 'expanded' : 'collapsed';

            if ($(rowSelectorPrefix + '1').text() != ' ') {
                if (!$(rowSelectorPrefix + '1 .expand-collapse-button').length) {
                    $(rowSelectorPrefix + '1').prepend($('<span class="expand-collapse-button"></span>'));
                }

                $(rowSelectorPrefix + '1 .expand-collapse-button')
                    .removeClass(previousState)
                    .addClass(state)
                    .html(arrow);
            }
        }

        function getNonHeaderRows() {
            return $('.panes .content')
                .children()
                .filter(function () {
                    return $(this).attr('class') != 'header';
                });
        }

        function getAllParentRowIndices() {
            var allIndices = getNonHeaderRows()
                .map(function () {
                    return $(this).attr('data-pid');
                })
                .get();

            return Array.from(new Set(allIndices))
        }

        function toggleExpansionOfParentRow(arrowElement) {
            var rowId = $(arrowElement).parent().parent().attr('id');
            var rowIndex = rowId.split('-')[1];

            if ($(arrowElement).attr('class').includes('collapsed')) {
                expandParentRowByIndex(rowIndex);
            } else {
                collapseParentRowByIndex(rowIndex);
            }
        }

        function expandDiffIfNecessary(diff) {
            var firstRowIndex = diff.l[0];
            var lastRowIndex = diff.l[1];

            if (!$rowVisibilityState[firstRowIndex]) {
                var parentRowIndex = getRowElementByIndex(firstRowIndex).attr('data-pid');
                expandParentRowByIndex(parentRowIndex);
            }

            if (!$rowVisibilityState[lastRowIndex]) {
                var parentRowIndex = getRowElementByIndex(lastRowIndex).attr('data-pid');
                expandParentRowByIndex(parentRowIndex);
            }

            appendDiffsForDirectory();
        }

        function expandParentRowByIndex(rowIndex) {
            getNonHeaderRows()
                .filter(function () {
                    return $(this).attr('data-pid') == rowIndex;
                })
                .each(function () {
                    var childRowIndex = $(this).attr('id').split('-')[1];

                    $rowVisibilityState[childRowIndex] = true;

                    $(this).removeClass('hd');
                })

            appendExpandCollapseButton(0, rowIndex, 'expanded');
            appendExpandCollapseButton(1, rowIndex, 'expanded');
        }

        function collapseParentRowByIndex(rowIndex) {
            var parentRowIndices = getAllParentRowIndices();

            getNonHeaderRows()
                .filter(function () {
                    return $(this).attr('data-pid') == rowIndex;
                })
                .each(function () {
                    var childRowIndex = $(this).attr('id').split('-')[1];

                    if (parentRowIndices.includes(childRowIndex)) {
                        collapseParentRowByIndex(childRowIndex)
                    }

                    $rowVisibilityState[childRowIndex] = false;

                    $(this).addClass('hd');
                })

            appendExpandCollapseButton(0, rowIndex, 'collapsed');
            appendExpandCollapseButton(1, rowIndex, 'collapsed');
        }

        function getCssValue(obj, name) {
            return parseInt(obj.css(name), 10);
        }

        function fitToWindow() {
            var containerPaddingTop = getCssValue($('#container'), 'padding-top');
            var containerPaddingBottom = getCssValue($('#container'), 'padding-bottom');
            var paneMarginTop = getCssValue($('.pane'), 'margin-top');
            var paneMarginBottom = getCssValue($('.pane'), 'margin-bottom');

            var panesHeight = $(window).height() - containerPaddingTop - containerPaddingBottom - $('#navigation').outerHeight(true) - $('#legend').outerHeight(true) - $('#generated_by').outerHeight(true);
            if ($useLineInspector) {
                panesHeight -= $('#inspector').outerHeight(true);
            }

            var fileHeight;
            if ($orientation == 'vertical') {
                fileHeight = panesHeight - $('.title').outerHeight(true) - paneMarginTop - paneMarginBottom;
            } else {
                fileHeight = (panesHeight - 2 * $('.title').outerHeight(true) - paneMarginTop - 2 * paneMarginBottom) / 2;
            }

            $('.file').height(fileHeight);

            if ($orientation == 'vertical') {
                // 5px is half of getCssValue($('.pane'), 'margin-left');
                $('.pane').css('width', 'calc(50% - 5px)');
                $('#pane1').css('margin-left', '0');
            } else {
                $('.pane').css('width', '100%').css('margin-left', '0');
                $('#pane2').css('margin-top', '0');
            }
        }

        function computeNumberOfVisibleRowsInRange(firstRowIndex, lastRowIndexExclusive) {
            var rowVisibilitySubset = $rowVisibilityState.slice(firstRowIndex, lastRowIndexExclusive);

            return rowVisibilitySubset.filter(function (isVisible) {
                return isVisible;
            }).length;
        }

        function populateDiffs() {
            if ($diffs.length > 1) {
                for (var i = 1; i < $diffs.length; i++) {
                    $('#currentDiff').append($('<option></option>').attr('value', i).text($diffs[i].d));
                    if ($mode != 'directory') {
                        $('.diffs').append($('<div class="diff"></div>')
                            .attr('title', $diffs[i].d)
                            .css('top', ($diffs[i].l[0] * $lineHeight) + 'px')
                            .height((($diffs[i].l[1] - $diffs[i].l[0] + 1) * $lineHeight)));
                    }
                    $('.d' + i).attr('title', $diffs[i].d);
                }

                if ($mode == 'directory') {
                    appendDiffsForDirectory();
                    var headerHeight = $('.header').outerHeight(true);
                    $('.diffs').css('margin-top', headerHeight + 'px');
                }

                $('.diffBar').show();
            } else {
                $('#currentDiff').append($('<option></option>').attr('value', 0).text('(No differences)'));
            }
        }

        function appendDiffsForDirectory() {
            if ($diffs.length > 1) {
                $('.diffs').empty()

                for (var i = 1; i < $diffs.length; i++) {
                    $('.diffs')
                        .append($('<div class="diff"></div>')
                            .attr('title', $diffs[i].d)
                            .css('top', (computeNumberOfVisibleRowsInRange(0, $diffs[i].l[0]) * $lineHeight) + 'px')
                            .height(computeNumberOfVisibleRowsInRange($diffs[i].l[0], $diffs[i].l[1] + 1) * $lineHeight));
                }
            }
        }

        function registerEventHandlers() {
            $('#currentDiff').bind('change keyup', function () {
                goto(currentDiff());
            });

            $('#file1').scroll(function (event) {
                syncScroll(event);
            });
            $('#file2').scroll(function (event) {
                syncScroll(event);
            });

            $('.file .l').click(function () {
                updateCurrentDiff(this);
                updateLineInspector(this);
            })

            $('.expand-collapse-button').click(function () {
                toggleExpansionOfParentRow(this);
                appendDiffsForDirectory();
            });

            $('.resize-divider').mousedown(function (e) {
                $isDraggingMouse = true;
                $idsBeingResized = $(this).attr('id').split('-');
            });

            $(document).mousemove(function (e) {
                if ($isDraggingMouse) {
                    // Get selectors for divs to the left and right of the divider
                    var firstBoxSelector = '.' + $idsBeingResized[0];
                    var secondBoxSelector = '.' + $idsBeingResized[1];

                    var firstBoxSelectorOppositePane = firstBoxSelector.includes('c1') ?
                        firstBoxSelector.replace('c1', 'c2') : firstBoxSelector.replace('c2', 'c1');
                    var secondBoxSelectorOppositePane = secondBoxSelector.includes('c1') ?
                        secondBoxSelector.replace('c1', 'c2') : secondBoxSelector.replace('c2', 'c1');

                    // Get current left offset of the boxes on the screen
                    var firstBoxOffsetLeft = $(firstBoxSelector).offset().left;
                    var secondBoxOffsetLeft = $(secondBoxSelector).offset().left;

                    // Compute new widths
                    var MIN_WIDTH = 50;
                    var PADDING_OFFSET = 3;

                    var originalFirstBoxWidth = $(firstBoxSelector).width() + PADDING_OFFSET;
                    var originalSecondBoxWidth = $(secondBoxSelector).width() + PADDING_OFFSET;

                    var maxFirstBoxWidth = (originalFirstBoxWidth + originalSecondBoxWidth) - MIN_WIDTH;

                    var newFirstBoxWidth = Math.min(Math.max(MIN_WIDTH, e.clientX - firstBoxOffsetLeft), maxFirstBoxWidth);
                    var newSecondBoxWidth = Math.max(MIN_WIDTH, originalSecondBoxWidth - (newFirstBoxWidth - originalFirstBoxWidth));

                    // Update widths
                    $(firstBoxSelector).css('width', newFirstBoxWidth);
                    $(secondBoxSelector).css('width', newSecondBoxWidth);
                    $(firstBoxSelector.replace('h', '')).not('.filter-row').css('width', newFirstBoxWidth)
                    $(secondBoxSelector.replace('h', '')).not('.filter-row').css('width', newSecondBoxWidth)

                    // Synchronize to opposite pane
                    $(firstBoxSelectorOppositePane).css('width', newFirstBoxWidth);
                    $(secondBoxSelectorOppositePane).css('width', newSecondBoxWidth);
                    $(firstBoxSelectorOppositePane.replace('h', '')).not('.filter-row').css('width', newFirstBoxWidth);
                    $(secondBoxSelectorOppositePane.replace('h', '')).not('.filter-row').css('width', newSecondBoxWidth);
                }
            });

            $(document).mouseup(function () {
                $isDraggingMouse = false;
                $idsBeingResized = [];
            });

            $('#btnFirst').click(firstDiff);
            $('#btnPrevious').click(previousDiff);
            $('#btnNext').click(nextDiff);
            $('#btnLast').click(lastDiff);
        }

        function syncScroll(e) {
            clearTimeout($scrollTimeout);

            if (!e) e = window.event;
            var $source = $(e.target);
            var $target = ($source.attr('id') == 'file1') ? $('#file2') : $('#file1')

            $target.off("scroll").scrollTop($source.scrollTop());
            $target.off("scroll").scrollLeft($source.scrollLeft());

            $scrollTimeout = setTimeout(function () {
                $target.scroll(syncScroll);
            }, 100, e);
        }

        function goto(diff) {
            if (diff > 0 && diff <= $diffs.length) {
                setLineInspector($diffs[diff].l[0]);

                if ($mode == 'directory') {
                    expandDiffIfNecessary($diffs[diff]);
                }

                markCurrentDiff(diff);

                if ($('.comparison .diffBar').css('display') != 'none') {
                    var block = $('.diff').eq(diff - 1);
                    var tableMidpoint = $('.file').height() / 2;

                    if (block.height() > $('.pane').height()) {
                        // Scroll to the top of the diff block
                        $('.file').scrollTop(block.position().top - $lineHeight);
                    } else {
                        // Scroll so that diff block is centered
                        var midpoint = block.position().top + (block.height() / 2);
                        $('.file').scrollTop(midpoint - tableMidpoint);
                    }
                } else {
                    // If diff bar's not shown, just scroll first diff line to top
                    var scrollPos = $('.d' + diff).first().position().top - $('.l').first().position().top;
                    if ($mode == 'directory') {
                        var headerHeight = $('.header').outerHeight(true);
                        scrollPos += headerHeight; // to account for header
                    }
                    $('.file').scrollTop(scrollPos);
                }
            }
        }

        function markCurrentDiff(diff) {
            $('#currentDiff').val(diff);

            $('.diff').removeClass('active');
            $('.comparison .diffs').each(function (i, diffBar) {
                $(diffBar).children().eq(diff - 1).addClass('active');
            });
        }

        function updateCurrentDiff(clickedDiv) {
            var lineNum = $(clickedDiv).parent().children('.l').index($(clickedDiv));
            markCurrentDiff(closestDiffToLine(lineNum));
        }

        function updateLineInspector(clickedDiv) {
            var lineNum = $(clickedDiv).parent().children('.l').index($(clickedDiv));
            setLineInspector(lineNum);
        }

        function setLineInspector(lineNum) {
            var leftLine = $($('#file1 .l').get(lineNum));
            var rightLine = $($('#file2 .l').get(lineNum));

            $('#inspectorLeftContent').html(leftLine.html())
                .attr('class', leftLine.attr('class'));
            $('#inspectorRightContent').html(rightLine.html())
                .attr('class', rightLine.attr('class'));

            if ($('.comparison .num').length > 0) {
                var leftNum = $($('#file1 .num').get(lineNum));
                var rightNum = $($('#file2 .num').get(lineNum));
                var maxNumWidth = Math.max(leftNum.width(), rightNum.width());

                $('#inspector .left .num').html(leftNum.html())
                    .width(maxNumWidth);
                $('#inspector .right .num').html(rightNum.html())
                    .width(maxNumWidth);
            } else {
                $('#inspector .num').html('')
                    .css('width', 0).css('border', 0).css('padding', 0);
            }

            var maxWidth = Math.max(calcDivWidth(leftLine), calcDivWidth(rightLine));
            $('#inspectorLeftContent').width(maxWidth);
            $('#inspectorRightContent').width(maxWidth);
        }

        function calcDivWidth(divElement) {
            var width = 0;
            divElement.children().each(function () {
                var $span = $(this);
                width += $span.width();
            });
            return width;
        }

        function closestDiffToLine(num) {
            var closest = {
                diff: null,
                dist: Infinity
            };

            for (var i = 1; i < $diffs.length; i++) {
                if ($diffs[i].l[0] <= num && $diffs[i].l[1] >= num) {
                    closest = { diff: i, dist: 0 };
                } else {
                    var dist = ($diffs[i].l[0] <= num) ? (num - $diffs[i].l[1]) : ($diffs[i].l[0] - num);
                    if (dist <= closest.dist) {
                        closest = { diff: i, dist: dist };
                    }
                }
            }

            return closest.diff;
        }

        function currentDiff() {
            return parseInt($('#currentDiff').val());
        }

        function firstDiff() {
            goto(1);
        }

        function previousDiff() {
            var diff = currentDiff();
            if (diff > 1) {
                diff--;
            }
            goto(diff);
        }

        function nextDiff() {
            var diff = currentDiff();
            if (diff < ($diffs.length - 1)) {
                diff++;
            }
            goto(diff);
        }

        function lastDiff() {
            goto($diffs.length - 1);
        }
    </script>
</head>

<body>
    <div id="container" style="">
        <!-- $JS_ONLY_BEGIN$ -->
        <table id="navigation">
            <tr>
                <td class="button" id="tdBtnFirst"><button title="First Difference" id="btnFirst"></button></td>
                <td class="button"><button title="Previous Difference" id="btnPrevious"></button></td>
                <td class="button"><button title="Next Difference" id="btnNext"></button></td>
                <td class="button"><button title="Last Difference" id="btnLast"></button></td>
                <td>
                    <div id="diff-select">
                        <select id="currentDiff" size="1"></select>
                    </div>
                </td>
            </tr>
        </table>
        <!-- $JS_ONLY_END$ -->

        <div class="text comparison">
            <div id="pane1" class="pane" style="">
                <div id="title1" class="title" style="" title="https://raw.githubusercontent.com/BalancerMaxis/MainChainGaugeInjector/main/src/MainChainGaugeInjector.sol">https://raw.githubusercontent.com/BalancerMaxis/MainChainGaugeInjector/main/src/MainChainGaugeInjector.sol</div>
                <div id="file1" class="file" style=" ">
                    <table class="panes">
                        <tr>
                            <td class="diffBar" style="display: none;">
                                <div class="diffs"></div>
                            </td>
                            <td class="nums">
                                <div class="num">  1 </div>
<div class="num">  2 </div>
<div class="num">  3 </div>
<div class="num">  4 </div>
<div class="num">  5 </div>
<div class="num">  6 </div>
<div class="num">  7 </div>
<div class="num">  8 </div>
<div class="num">  9 </div>
<div class="num"> 10 </div>
<div class="num"> 11 </div>
<div class="num">    </div>
<div class="num"> 12 </div>
<div class="num"> 13 </div>
<div class="num"> 14 </div>
<div class="num"> 15 </div>
<div class="num"> 16 </div>
<div class="num"> 17 </div>
<div class="num"> 18 </div>
<div class="num"> 19 </div>
<div class="num"> 20 </div>
<div class="num"> 21 </div>
<div class="num"> 22 </div>
<div class="num"> 23 </div>
<div class="num"> 24 </div>
<div class="num"> 25 </div>
<div class="num"> 26 </div>
<div class="num"> 27 </div>
<div class="num"> 28 </div>
<div class="num"> 29 </div>
<div class="num"> 30 </div>
<div class="num"> 31 </div>
<div class="num"> 32 </div>
<div class="num"> 33 </div>
<div class="num"> 34 </div>
<div class="num"> 35 </div>
<div class="num"> 36 </div>
<div class="num"> 37 </div>
<div class="num"> 38 </div>
<div class="num"> 39 </div>
<div class="num"> 40 </div>
<div class="num"> 41 </div>
<div class="num"> 42 </div>
<div class="num"> 43 </div>
<div class="num"> 44 </div>
<div class="num"> 45 </div>
<div class="num"> 46 </div>
<div class="num"> 47 </div>
<div class="num"> 48 </div>
<div class="num"> 49 </div>
<div class="num"> 50 </div>
<div class="num"> 51 </div>
<div class="num"> 52 </div>
<div class="num"> 53 </div>
<div class="num"> 54 </div>
<div class="num"> 55 </div>
<div class="num"> 56 </div>
<div class="num">    </div>
<div class="num"> 57 </div>
<div class="num"> 58 </div>
<div class="num"> 59 </div>
<div class="num"> 60 </div>
<div class="num"> 61 </div>
<div class="num"> 62 </div>
<div class="num"> 63 </div>
<div class="num"> 64 </div>
<div class="num"> 65 </div>
<div class="num"> 66 </div>
<div class="num"> 67 </div>
<div class="num"> 68 </div>
<div class="num"> 69 </div>
<div class="num"> 70 </div>
<div class="num"> 71 </div>
<div class="num"> 72 </div>
<div class="num"> 73 </div>
<div class="num"> 74 </div>
<div class="num"> 75 </div>
<div class="num"> 76 </div>
<div class="num"> 77 </div>
<div class="num"> 78 </div>
<div class="num"> 79 </div>
<div class="num"> 80 </div>
<div class="num"> 81 </div>
<div class="num"> 82 </div>
<div class="num"> 83 </div>
<div class="num"> 84 </div>
<div class="num"> 85 </div>
<div class="num"> 86 </div>
<div class="num"> 87 </div>
<div class="num"> 88 </div>
<div class="num"> 89 </div>
<div class="num"> 90 </div>
<div class="num"> 91 </div>
<div class="num"> 92 </div>
<div class="num"> 93 </div>
<div class="num"> 94 </div>
<div class="num"> 95 </div>
<div class="num"> 96 </div>
<div class="num"> 97 </div>
<div class="num"> 98 </div>
<div class="num"> 99 </div>
<div class="num">100 </div>
<div class="num">    </div>
<div class="num">101 </div>
<div class="num">102 </div>
<div class="num">103 </div>
<div class="num">104 </div>
<div class="num">105 </div>
<div class="num">106 </div>
<div class="num">107 </div>
<div class="num">108 </div>
<div class="num">109 </div>
<div class="num">110 </div>
<div class="num">111 </div>
<div class="num">112 </div>
<div class="num">113 </div>
<div class="num">114 </div>
<div class="num">115 </div>
<div class="num">116 </div>
<div class="num">117 </div>
<div class="num">118 </div>
<div class="num">119 </div>
<div class="num">120 </div>
<div class="num">121 </div>
<div class="num">122 </div>
<div class="num">123 </div>
<div class="num">124 </div>
<div class="num">125 </div>
<div class="num">126 </div>
<div class="num">127 </div>
<div class="num">128 </div>
<div class="num">129 </div>
<div class="num">130 </div>
<div class="num">131 </div>
<div class="num">132 </div>
<div class="num">133 </div>
<div class="num">134 </div>
<div class="num">135 </div>
<div class="num">136 </div>
<div class="num">137 </div>
<div class="num">138 </div>
<div class="num">139 </div>
<div class="num">140 </div>
<div class="num">141 </div>
<div class="num">142 </div>
<div class="num">143 </div>
<div class="num">144 </div>
<div class="num">145 </div>
<div class="num">146 </div>
<div class="num">147 </div>
<div class="num">148 </div>
<div class="num">149 </div>
<div class="num">150 </div>
<div class="num">151 </div>
<div class="num">152 </div>
<div class="num">153 </div>
<div class="num">154 </div>
<div class="num">155 </div>
<div class="num">156 </div>
<div class="num">157 </div>
<div class="num">158 </div>
<div class="num">159 </div>
<div class="num">160 </div>
<div class="num">161 </div>
<div class="num">162 </div>
<div class="num">163 </div>
<div class="num">164 </div>
<div class="num">165 </div>
<div class="num">166 </div>
<div class="num">167 </div>
<div class="num">168 </div>
<div class="num">169 </div>
<div class="num">170 </div>
<div class="num">171 </div>
<div class="num">172 </div>
<div class="num">173 </div>
<div class="num">174 </div>
<div class="num">175 </div>
<div class="num">176 </div>
<div class="num">177 </div>
<div class="num">178 </div>
<div class="num">179 </div>
<div class="num">180 </div>
<div class="num">181 </div>
<div class="num">182 </div>
<div class="num">183 </div>
<div class="num">184 </div>
<div class="num">185 </div>
<div class="num">186 </div>
<div class="num">187 </div>
<div class="num">188 </div>
<div class="num">189 </div>
<div class="num">190 </div>
<div class="num">191 </div>
<div class="num">192 </div>
<div class="num">193 </div>
<div class="num">194 </div>
<div class="num">195 </div>
<div class="num">196 </div>
<div class="num">197 </div>
<div class="num">198 </div>
<div class="num">199 </div>
<div class="num">200 </div>
<div class="num">201 </div>
<div class="num">202 </div>
<div class="num">203 </div>
<div class="num">204 </div>
<div class="num">205 </div>
<div class="num">206 </div>
<div class="num">207 </div>
<div class="num">208 </div>
<div class="num">209 </div>
<div class="num">210 </div>
<div class="num">    </div>
<div class="num">211 </div>
<div class="num">212 </div>
<div class="num">213 </div>
<div class="num">214 </div>
<div class="num">215 </div>
<div class="num">216 </div>
<div class="num">217 </div>
<div class="num">218 </div>
<div class="num">219 </div>
<div class="num">220 </div>
<div class="num">221 </div>
<div class="num">222 </div>
<div class="num">223 </div>
<div class="num">224 </div>
<div class="num">225 </div>
<div class="num">226 </div>
<div class="num">227 </div>
<div class="num">228 </div>
<div class="num">    </div>
<div class="num">229 </div>
<div class="num">230 </div>
<div class="num">231 </div>
<div class="num">232 </div>
<div class="num">233 </div>
<div class="num">234 </div>
<div class="num">235 </div>
<div class="num">236 </div>
<div class="num">237 </div>
<div class="num">238 </div>
<div class="num">239 </div>
<div class="num">240 </div>
<div class="num">241 </div>
<div class="num">242 </div>
<div class="num">243 </div>
<div class="num">244 </div>
<div class="num">245 </div>
<div class="num">246 </div>
<div class="num">247 </div>
<div class="num">248 </div>
<div class="num">249 </div>
<div class="num">250 </div>
<div class="num">251 </div>
<div class="num">252 </div>
<div class="num">253 </div>
<div class="num">254 </div>
<div class="num">255 </div>
<div class="num">256 </div>
<div class="num">257 </div>
<div class="num">258 </div>
<div class="num">259 </div>
<div class="num">260 </div>
<div class="num">261 </div>
<div class="num">262 </div>
<div class="num">263 </div>
<div class="num">264 </div>
<div class="num">265 </div>
<div class="num">266 </div>
<div class="num">267 </div>
<div class="num">268 </div>
<div class="num">269 </div>
<div class="num">270 </div>
<div class="num">271 </div>
<div class="num">272 </div>
<div class="num">273 </div>
<div class="num">274 </div>
<div class="num">275 </div>
<div class="num">276 </div>
<div class="num">277 </div>
<div class="num">278 </div>
<div class="num">279 </div>
<div class="num">280 </div>
<div class="num">281 </div>
<div class="num">282 </div>
<div class="num">283 </div>
<div class="num">284 </div>
<div class="num">285 </div>
<div class="num">286 </div>
<div class="num">287 </div>
<div class="num">288 </div>
<div class="num">289 </div>
<div class="num">290 </div>
<div class="num">291 </div>
<div class="num">292 </div>
<div class="num">293 </div>
<div class="num">294 </div>
<div class="num">295 </div>
<div class="num">296 </div>
<div class="num">297 </div>
<div class="num">298 </div>
<div class="num">299 </div>
<div class="num">300 </div>
<div class="num">301 </div>
<div class="num">302 </div>
<div class="num">303 </div>
<div class="num">304 </div>
<div class="num">305 </div>
<div class="num">306 </div>
<div class="num">307 </div>
<div class="num">308 </div>
<div class="num">309 </div>
<div class="num">310 </div>
<div class="num">311 </div>
<div class="num">312 </div>
<div class="num">313 </div>
<div class="num">314 </div>
<div class="num">315 </div>
<div class="num">316 </div>
<div class="num">317 </div>
<div class="num">    </div>
<div class="num">    </div>
<div class="num">318 </div>
<div class="num">319 </div>
<div class="num">320 </div>
<div class="num">321 </div>
<div class="num">322 </div>
<div class="num">323 </div>
<div class="num">324 </div>
<div class="num">325 </div>
<div class="num">326 </div>
<div class="num">327 </div>
<div class="num">328 </div>
<div class="num">329 </div>
<div class="num">330 </div>
<div class="num">331 </div>
<div class="num">332 </div>
<div class="num">333 </div>
<div class="num">334 </div>
<div class="num">335 </div>
<div class="num">336 </div>
<div class="num">337 </div>
<div class="num">338 </div>
<div class="num">339 </div>
<div class="num">340 </div>
<div class="num">341 </div>
<div class="num">342 </div>
<div class="num">343 </div>
<div class="num">344 </div>
<div class="num">345 </div>
<div class="num">346 </div>
<div class="num">347 </div>
<div class="num">348 </div>
<div class="num">349 </div>
<div class="num">350 </div>
<div class="num">351 </div>
<div class="num">352 </div>
<div class="num">353 </div>
<div class="num">354 </div>
<div class="num">355 </div>
<div class="num">356 </div>
<div class="num">357 </div>
<div class="num">358 </div>
<div class="num">359 </div>
<div class="num">360 </div>
<div class="num">361 </div>
<div class="num">362 </div>
<div class="num">363 </div>
<div class="num">364 </div>
<div class="num">365 </div>
<div class="num">366 </div>
<div class="num">367 </div>
<div class="num">368 </div>
<div class="num">369 </div>
<div class="num">370 </div>
<div class="num">371 </div>
<div class="num">372 </div>
<div class="num">373 </div>
<div class="num">374 </div>
<div class="num">375 </div>
<div class="num">376 </div>
<div class="num">377 </div>
<div class="num">378 </div>
<div class="num">379 </div>
<div class="num">380 </div>
<div class="num">381 </div>
<div class="num">382 </div>
<div class="num">383 </div>
<div class="num">384 </div>
<div class="num">385 </div>
<div class="num">386 </div>
<div class="num">387 </div>
<div class="num">388 </div>
<div class="num">389 </div>
<div class="num">390 </div>
<div class="num">391 </div>
<div class="num">392 </div>
<div class="num">393 </div>
<div class="num">394 </div>
<div class="num">395 </div>
<div class="num">396 </div>
<div class="num">397 </div>
<div class="num">398 </div>
<div class="num">399 </div>
<div class="num">400 </div>
<div class="num">401 </div>
<div class="num">402 </div>
<div class="num">403 </div>
<div class="num">404 </div>
<div class="num">405 </div>
<div class="num">406 </div>
<div class="num">407 </div>
<div class="num">408 </div>
<div class="num">409 </div>
<div class="num">410 </div>
<div class="num">411 </div>
<div class="num">412 </div>
<div class="num">413 </div>
<div class="num">414 </div>
<div class="num">415 </div>
<div class="num">416 </div>
<div class="num">417 </div>
<div class="num">418 </div>
<div class="num">419 </div>
<div class="num">420 </div>
<div class="num">421 </div>
<div class="num">422 </div>
<div class="num">423 </div>
<div class="num">424 </div>
<div class="num">425 </div>
<div class="num">426 </div>
<div class="num">427 </div>
<div class="num">428 </div>
<div class="num">429 </div>
<div class="num">430 </div>
<div class="num">431 </div>
<div class="num">432 </div>
<div class="num">433 </div>
<div class="num">434 </div>
<div class="num">435 </div>
<div class="num">436 </div>
<div class="num">437 </div>
<div class="num">438 </div>
<div class="num">439 </div>
<div class="num">440 </div>
<div class="num">441 </div>
<div class="num">442 </div>
<div class="num">443 </div>
<div class="num">444 </div>
<div class="num">445 </div>
<div class="num">446 </div>
<div class="num">447 </div>
<div class="num">448 </div>
<div class="num">449 </div>
<div class="num">450 </div>
<div class="num">451 </div>
<div class="num">452 </div>
<div class="num">453 </div>
<div class="num">454 </div>
<div class="num">455 </div>
<div class="num">456 </div>
<div class="num">457 </div>
<div class="num">458 </div>
<div class="num">459 </div>
<div class="num">460 </div>
<div class="num">461 </div>
<div class="num">462 </div>
<div class="num">463 </div>
<div class="num">464 </div>
<div class="num">465 </div>
<div class="num">466 </div>
<div class="num">467 </div>
<div class="num">468 </div>
<div class="num">469 </div>
<div class="num">470 </div>
<div class="num">471 </div>
<div class="num">472 </div>
<div class="num">473 </div>
<div class="num">474 </div>
<div class="num">475 </div>
<div class="num">476 </div>
<div class="num">477 </div>

                            </td>
                            <td class="content">
                                <div class="l li"><span class="si">// SPDX-License-Identifier: MIT</span></div>
<div class="l li"></div>
<div class="l li"><span class="si">pragma solidity ^0.8.18;</span></div>
<div class="l li"></div>
<div class="l li"><span class="si">import &quot;@chainlink/contracts/src/v0.8/ConfirmedOwner.sol&quot;;</span></div>
<div class="l li"><span class="si">import &quot;@chainlink/contracts/src/v0.8/interfaces/KeeperCompatibleInterface.sol&quot;;</span></div>
<div class="l li"><span class="si">import &quot;@openzeppelin/contracts/security/Pausable.sol&quot;;</span></div>
<div class="l li"><span class="si">import &quot;@openzeppelin/contracts/token/ERC20/utils/SafeERC20.sol&quot;;</span></div>
<div class="l li"><span class="si">import &quot;@openzeppelin/contracts/token/ERC20/IERC20.sol&quot;;</span></div>
<div class="l lc d1"><span class="sc">import &quot;</span><span class="sd">./</span><span class="sc">interfaces/</span><span class="sc2">IMainChainGauge</span><span class="sc">.sol&quot;;</span></div>
<div class="l li"></div>
<div class="l li"></div>
<div class="l li"><span class="si">/**</span></div>
<div class="l lc d2"><span class="sc"> * @title The </span><span class="sc2">MainChainGaugeInjector</span><span class="sc"> Contract</span></div>
<div class="l li"><span class="si"> * @author 0xtritium.eth + master coder Mike B</span></div>
<div class="l li"><span class="si"> * @notice This contract is a chainlink automation compatible interface to automate regular payment of non-BAL tokens to a child chain gauge.</span></div>
<div class="l li"><span class="si"> * @notice This contract is meant to run/manage a single token.  This is almost always the case for a DAO trying to use such a thing.</span></div>
<div class="l li"><span class="si"> * @notice The configuration is rewritten each time it is loaded.</span></div>
<div class="l li"><span class="si"> * @notice This contract will only function if it is configured as the distributor for a token/gauge it is operating on.</span></div>
<div class="l li"><span class="si"> * @notice The contract is meant to hold token balances, and works on a schedule set using setRecipientList.  The schedule defines an amount per round and number of rounds per gauge.</span></div>
<div class="l li"><span class="si"> * @notice This contract is Ownable and has lots of sweep functionality to allow the owner to work with the contract or get tokens out should there be a problem.</span></div>
<div class="l ld d3"><span class="sd"> * @dev This release only works on mainnet, due to differences in the interface of mainchain/childchain gauges!!!</span></div>
<div class="l li"><span class="si"> * see https://docs.chain.link/chainlink-automation/utility-contracts/</span></div>
<div class="l li"><span class="si"> */</span></div>
<div class="l lc d4"><span class="sc">contract </span><span class="sc2">MainChainGaugeInjector</span><span class="sc"> is</span></div>
<div class="l lc d4"><span class="sc">  </span><span class="sd">ConfirmedOwner,</span></div>
<div class="l lc d4"><span class="sc">  </span><span class="sd">Pausable,</span></div>
<div class="l lc d4"><span class="sc">  </span><span class="sd">KeeperCompatibleInterface</span></div>
<div class="l lc d4"><span class="sd">{</span></div>
<div class="l li"><span class="si">  event GasTokenWithdrawn(uint256 amountWithdrawn, address recipient);</span></div>
<div class="l li"><span class="si">  event KeeperRegistryAddressUpdated(address oldAddress, address newAddress);</span></div>
<div class="l lc d5"><span class="sc">  event MinWaitPeriodUpdated(</span></div>
<div class="l lc d5"><span class="sc">    </span><span class="sd">uint256 oldMinWaitPeriod,</span></div>
<div class="l lc d5"><span class="sc">    </span><span class="sd">uint256 newMinWaitPeriod</span></div>
<div class="l lc d5"><span class="sc">  </span><span class="sd">);</span></div>
<div class="l li"><span class="si">  event ERC20Swept(address indexed token, address recipient, uint256 amount);</span></div>
<div class="l li"><span class="si">  event EmissionsInjection(address gauge, address token, uint256 amount);</span></div>
<div class="l li"><span class="si">  event SetHandlingToken(address token);</span></div>
<div class="l li"><span class="si">  event PerformedUpkeep(address[] needsFunding);</span></div>
<div class="l li"></div>
<div class="l li"><span class="si">  error ListLengthMismatch();</span></div>
<div class="l li"><span class="si">  error OnlyKeeperRegistry(address sender);</span></div>
<div class="l li"><span class="si">  error DuplicateAddress(address duplicate);</span></div>
<div class="l li"><span class="si">  error PeriodNotFinished(uint256 periodNumber, uint256 maxPeriods);</span></div>
<div class="l li"><span class="si">  error ZeroAddress();</span></div>
<div class="l li"><span class="si">  error ZeroAmount();</span></div>
<div class="l li"><span class="si">  error BalancesMismatch();</span></div>
<div class="l li"><span class="si">  error RewardTokenError();</span></div>
<div class="l li"></div>
<div class="l li"><span class="si">  struct Target {</span></div>
<div class="l li"><span class="si">    uint256 amountPerPeriod;</span></div>
<div class="l li"><span class="si">    bool isActive;</span></div>
<div class="l li"><span class="si">    uint8 maxPeriods;</span></div>
<div class="l li"><span class="si">    uint8 periodNumber;</span></div>
<div class="l li"><span class="si">    uint56 lastInjectionTimeStamp; // enough space for 2 trillion years</span></div>
<div class="l li"><span class="si">  }</span></div>
<div class="l li"></div>
<div class="l li"></div>
<div class="l li"><span class="si">  address private s_keeperRegistryAddress;</span></div>
<div class="l li"><span class="si">  uint256 private s_minWaitPeriodSeconds;</span></div>
<div class="l li"><span class="si">  address[] private s_gaugeList;</span></div>
<div class="l li"><span class="si">  mapping(address =&gt; Target) internal s_targets;</span></div>
<div class="l li"><span class="si">  address private s_injectTokenAddress;</span></div>
<div class="l li"></div>
<div class="l li"><span class="si">  /**</span></div>
<div class="l li"><span class="si">   * @param keeperRegistryAddress The address of the keeper registry contract</span></div>
<div class="l li"><span class="si">   * @param minWaitPeriodSeconds The minimum wait period for address between funding (for security)</span></div>
<div class="l li"><span class="si">   * @param injectTokenAddress The ERC20 token this contract should mange</span></div>
<div class="l li"><span class="si">   */</span></div>
<div class="l lc d6"><span class="sc">  constructor(</span></div>
<div class="l lc d6"><span class="sc">    </span><span class="sc2">address keeperRegistryAddress,</span></div>
<div class="l lc d6"><span class="sc">    </span><span class="sc2">uint256 minWaitPeriodSeconds,</span></div>
<div class="l lc d6"><span class="sc">    </span><span class="sd">address injectTokenAddress</span></div>
<div class="l lc d6"><span class="sc">  </span><span class="sd">) ConfirmedOwner(msg.sender) {</span></div>
<div class="l li"><span class="si">    setKeeperRegistryAddress(keeperRegistryAddress);</span></div>
<div class="l li"><span class="si">    setMinWaitPeriodSeconds(minWaitPeriodSeconds);</span></div>
<div class="l li"><span class="si">    setInjectTokenAddress(injectTokenAddress);</span></div>
<div class="l li"><span class="si">  }</span></div>
<div class="l li"></div>
<div class="l li"><span class="si">  /**</span></div>
<div class="l li"><span class="si">   * @notice Sets the list of addresses to watch and their funding parameters</span></div>
<div class="l li"><span class="si">   * @param gaugeAddresses the list of addresses to watch</span></div>
<div class="l li"><span class="si">   * @param amountsPerPeriod the minimum balances for each address</span></div>
<div class="l li"><span class="si">   * @param maxPeriods the amount to top up each address</span></div>
<div class="l li"><span class="si">   */</span></div>
<div class="l li"><span class="si">  function setRecipientList(</span></div>
<div class="l li"><span class="si">    address[] calldata gaugeAddresses,</span></div>
<div class="l li"><span class="si">    uint256[] calldata amountsPerPeriod,</span></div>
<div class="l li"><span class="si">    uint8[] calldata maxPeriods</span></div>
<div class="l li"><span class="si">  ) public onlyOwner {</span></div>
<div class="l lc d7"><span class="sc">    if (</span></div>
<div class="l lc d7"><span class="sc">      </span><span class="sd">gaugeAddresses.length != amountsPerPeriod.length ||</span></div>
<div class="l lc d7"><span class="sc">      </span><span class="sd">gaugeAddresses.length != maxPeriods.length</span></div>
<div class="l lc d7"><span class="sc">    </span><span class="sd">) {</span></div>
<div class="l li"><span class="si">      revert ListLengthMismatch();</span></div>
<div class="l li"><span class="si">    }</span></div>
<div class="l li"><span class="si">    revertOnDuplicate(gaugeAddresses);</span></div>
<div class="l li"><span class="si">    address[] memory oldGaugeList = s_gaugeList;</span></div>
<div class="l li"><span class="si">    for (uint256 idx = 0; idx &lt; oldGaugeList.length; idx++) {</span></div>
<div class="l li"><span class="si">      s_targets[oldGaugeList[idx]].isActive = false;</span></div>
<div class="l li"><span class="si">    }</span></div>
<div class="l li"><span class="si">    for (uint256 idx = 0; idx &lt; gaugeAddresses.length; idx++) {</span></div>
<div class="l li"></div>
<div class="l li"><span class="si">      if (gaugeAddresses[idx] == address(0)) {</span></div>
<div class="l li"><span class="si">        revert ZeroAddress();</span></div>
<div class="l li"><span class="si">      }</span></div>
<div class="l li"><span class="si">      if (amountsPerPeriod[idx] == 0) {</span></div>
<div class="l li"><span class="si">        revert ZeroAmount();</span></div>
<div class="l li"><span class="si">      }</span></div>
<div class="l li"><span class="si">      s_targets[gaugeAddresses[idx]] = Target({</span></div>
<div class="l li"><span class="si">        isActive: true,</span></div>
<div class="l li"><span class="si">        amountPerPeriod: amountsPerPeriod[idx],</span></div>
<div class="l li"><span class="si">        maxPeriods: maxPeriods[idx],</span></div>
<div class="l li"><span class="si">        lastInjectionTimeStamp: 0,</span></div>
<div class="l li"><span class="si">        periodNumber: 0</span></div>
<div class="l li"><span class="si">      });</span></div>
<div class="l li"><span class="si">    }</span></div>
<div class="l li"><span class="si">    s_gaugeList = gaugeAddresses;</span></div>
<div class="l li"><span class="si">  }</span></div>
<div class="l li"></div>
<div class="l li"><span class="si">  /**</span></div>
<div class="l li"><span class="si">   * @notice Validate that all periods are finished, and that the supplied schedule has enough tokens to fully execute</span></div>
<div class="l li"><span class="si">   * @notice If everything checks out, update recipient list, otherwise, throw revert</span></div>
<div class="l li"><span class="si">   * @notice you can use setRecipientList to set a list without validation</span></div>
<div class="l li"><span class="si">   * @param gaugeAddresses : list of gauge addresses</span></div>
<div class="l li"><span class="si">   * @param amountsPerPeriod : list of amount of token in wei to be injected each week</span></div>
<div class="l li"><span class="si">   */</span></div>
<div class="l li"><span class="si">  function setValidatedRecipientList(</span></div>
<div class="l li"><span class="si">    address[] calldata gaugeAddresses,</span></div>
<div class="l li"><span class="si">    uint256[] calldata amountsPerPeriod,</span></div>
<div class="l li"><span class="si">    uint8[] calldata maxPeriods</span></div>
<div class="l li"><span class="si">  ) external onlyOwner {</span></div>
<div class="l li"><span class="si">    address[] memory gaugeList = s_gaugeList;</span></div>
<div class="l li"><span class="si">    // validate all periods are finished</span></div>
<div class="l li"><span class="si">    for (uint256 idx = 0; idx &lt; gaugeList.length; idx++) {</span></div>
<div class="l li"><span class="si">      Target memory target = s_targets[gaugeList[idx]];</span></div>
<div class="l li"><span class="si">      if (target.periodNumber &lt; target.maxPeriods) {</span></div>
<div class="l li"><span class="si">        revert PeriodNotFinished(target.periodNumber, target.maxPeriods);</span></div>
<div class="l li"><span class="si">      }</span></div>
<div class="l li"><span class="si">    }</span></div>
<div class="l li"><span class="si">    setRecipientList(gaugeAddresses, amountsPerPeriod, maxPeriods);</span></div>
<div class="l li"></div>
<div class="l li"><span class="si">    if (!checkSufficientBalances()) {</span></div>
<div class="l li"><span class="si">      revert BalancesMismatch();</span></div>
<div class="l li"><span class="si">    }</span></div>
<div class="l li"><span class="si">  }</span></div>
<div class="l li"></div>
<div class="l li"><span class="si">  /**</span></div>
<div class="l li"><span class="si">   * @notice Validate that the contract holds enough tokens to fulfill the current schedule</span></div>
<div class="l li"><span class="si">   * @return bool true if balance of contract matches scheduled periods</span></div>
<div class="l li"><span class="si">   */</span></div>
<div class="l li"><span class="si">  function checkSufficientBalances() public view returns (bool) {</span></div>
<div class="l li"><span class="si">    // iterates through all gauges to make sure there are enough tokens in the contract to fulfill all scheduled tasks</span></div>
<div class="l li"><span class="si">    // (maxperiods - periodnumber) * amountPerPeriod ==  token.balanceOf(address(this))</span></div>
<div class="l li"></div>
<div class="l li"><span class="si">    address[] memory gaugeList = s_gaugeList;</span></div>
<div class="l li"><span class="si">    uint256 totalDue;</span></div>
<div class="l li"><span class="si">    for (uint256 idx = 0; idx &lt; gaugeList.length; idx++) {</span></div>
<div class="l li"><span class="si">      Target memory target = s_targets[gaugeList[idx]];</span></div>
<div class="l lc d8"><span class="sc">      totalDue +=</span></div>
<div class="l lc d8"><span class="sc">        </span><span class="sd">(target.maxPeriods - target.periodNumber) *</span></div>
<div class="l lc d8"><span class="sc">        </span><span class="sd">target.amountPerPeriod;</span></div>
<div class="l li"><span class="si">    }</span></div>
<div class="l li"><span class="si">    return totalDue &lt;= IERC20(s_injectTokenAddress).balanceOf(address(this));</span></div>
<div class="l li"><span class="si">  }</span></div>
<div class="l li"></div>
<div class="l li"><span class="si">  /**</span></div>
<div class="l li"><span class="si">   * @notice Gets a list of addresses that are ready to inject</span></div>
<div class="l li"><span class="si">   * @notice This is done by checking if the current period has ended, and should inject new funds directly after the end of each period.</span></div>
<div class="l li"><span class="si">   * @return list of addresses that are ready to inject</span></div>
<div class="l li"><span class="si">   */</span></div>
<div class="l li"><span class="si">  function getReadyGauges() public view returns (address[] memory) {</span></div>
<div class="l li"><span class="si">    address[] memory gaugeList = s_gaugeList;</span></div>
<div class="l li"><span class="si">    address[] memory ready = new address[](gaugeList.length);</span></div>
<div class="l li"><span class="si">    address tokenAddress = s_injectTokenAddress;</span></div>
<div class="l li"><span class="si">    uint256 count = 0;</span></div>
<div class="l li"><span class="si">    uint256 minWaitPeriod = s_minWaitPeriodSeconds;</span></div>
<div class="l li"><span class="si">    uint256 balance = IERC20(tokenAddress).balanceOf(address(this));</span></div>
<div class="l li"><span class="si">    Target memory target;</span></div>
<div class="l li"><span class="si">    for (uint256 idx = 0; idx &lt; gaugeList.length; idx++) {</span></div>
<div class="l li"><span class="si">      target = s_targets[gaugeList[idx]];</span></div>
<div class="l lc d9"><span class="sc">      </span><span class="sc2">IMainChainGauge</span><span class="sc"> gauge = </span><span class="sc2">IMainChainGauge</span><span class="sc">(gaugeList[idx]);</span></div>
<div class="l li"></div>
<div class="l li"><span class="si">      uint256 period_finish = gauge.reward_data(tokenAddress).period_finish;</span></div>
<div class="l li"></div>
<div class="l li"><span class="si">      if (</span></div>
<div class="l li"><span class="si">        target.lastInjectionTimeStamp + minWaitPeriod &lt;= block.timestamp &amp;&amp;</span></div>
<div class="l li"><span class="si">        (period_finish &lt;= block.timestamp) &amp;&amp;</span></div>
<div class="l li"><span class="si">        balance &gt;= target.amountPerPeriod &amp;&amp;</span></div>
<div class="l li"><span class="si">        target.periodNumber &lt; target.maxPeriods &amp;&amp;</span></div>
<div class="l li"><span class="si">        gauge.reward_data(tokenAddress).distributor == address(this)</span></div>
<div class="l li"><span class="si">      ) {</span></div>
<div class="l li"><span class="si">        ready[count] = gaugeList[idx];</span></div>
<div class="l li"><span class="si">        count++;</span></div>
<div class="l li"><span class="si">        balance -= target.amountPerPeriod;</span></div>
<div class="l li"><span class="si">      }</span></div>
<div class="l li"><span class="si">    }</span></div>
<div class="l li"><span class="si">    if (count != gaugeList.length) {</span></div>
<div class="l li"><span class="si">      // ready is a list large enough to hold all possible gauges</span></div>
<div class="l li"><span class="si">      // count is the number of ready gauges that were inserted into ready</span></div>
<div class="l li"><span class="si">      // this assembly shrinks ready to length count such that it removes empty elements</span></div>
<div class="l li"><span class="si">      assembly {</span></div>
<div class="l li"><span class="si">        mstore(ready, count)</span></div>
<div class="l li"><span class="si">      }</span></div>
<div class="l li"><span class="si">    }</span></div>
<div class="l li"><span class="si">    return ready;</span></div>
<div class="l li"><span class="si">  }</span></div>
<div class="l li"></div>
<div class="l li"><span class="si">  /**</span></div>
<div class="l li"><span class="si">   * @notice Injects funds into the gauges provided</span></div>
<div class="l li"><span class="si">   * @param ready the list of gauges to fund (addresses must be pre-approved)</span></div>
<div class="l li"><span class="si">   */</span></div>
<div class="l li"><span class="si">  function _injectFunds(address[] memory ready) internal whenNotPaused {</span></div>
<div class="l la d10"></div>
<div class="l li"><span class="si">    address tokenAddress = s_injectTokenAddress;</span></div>
<div class="l li"><span class="si">    IERC20 token = IERC20(tokenAddress);</span></div>
<div class="l li"><span class="si">    uint256 balance = token.balanceOf(address(this));</span></div>
<div class="l li"><span class="si">    Target memory target;</span></div>
<div class="l li"></div>
<div class="l li"><span class="si">    for (uint256 idx = 0; idx &lt; ready.length; idx++) {</span></div>
<div class="l li"><span class="si">      target = s_targets[ready[idx]];</span></div>
<div class="l lc d11"><span class="sc">      </span><span class="sc2">IMainChainGauge</span><span class="sc"> gauge = </span><span class="sc2">IMainChainGauge</span><span class="sc">(ready[idx]);</span></div>
<div class="l li"><span class="si">      uint256 period_finish = gauge.reward_data(tokenAddress).period_finish;</span></div>
<div class="l li"></div>
<div class="l li"><span class="si">      if (</span></div>
<div class="l lc d12"><span class="sc">        target.lastInjectionTimeStamp + s_minWaitPeriodSeconds &lt;=</span></div>
<div class="l lc d12"><span class="sc">        </span><span class="sd">block.timestamp &amp;&amp;</span></div>
<div class="l li"><span class="si">        period_finish &lt;= block.timestamp &amp;&amp;</span></div>
<div class="l li"><span class="si">        balance &gt;= target.amountPerPeriod &amp;&amp;</span></div>
<div class="l li"><span class="si">        target.periodNumber &lt; target.maxPeriods &amp;&amp;</span></div>
<div class="l li"><span class="si">        target.isActive == true</span></div>
<div class="l li"><span class="si">      ) {</span></div>
<div class="l li"></div>
<div class="l li"><span class="si">        SafeERC20.safeApprove(token, ready[idx], target.amountPerPeriod);</span></div>
<div class="l li"></div>
<div class="l lc d13"><span class="sc">        try</span></div>
<div class="l lc d13"><span class="sc">          </span><span class="sd">gauge.deposit_reward_token(</span></div>
<div class="l lc d13"><span class="sc">            </span><span class="sd">tokenAddress,</span></div>
<div class="l lc d13"><span class="sc">            </span><span class="sd">uint256(target.amountPerPeriod)</span></div>
<div class="l lc d13"><span class="sc">          </span><span class="sd">)</span></div>
<div class="l lc d13"><span class="sc">        </span><span class="sd">{</span></div>
<div class="l lc d13"><span class="sc">          s_targets[ready[idx]].lastInjectionTimeStamp = uint56(</span></div>
<div class="l lc d13"><span class="sc">            </span><span class="sd">block.timestamp</span></div>
<div class="l lc d13"><span class="sc">          </span><span class="sd">);</span></div>
<div class="l li"><span class="si">          s_targets[ready[idx]].periodNumber++;</span></div>
<div class="l lc d14"><span class="sc">          emit EmissionsInjection(</span></div>
<div class="l lc d14"><span class="sc">            </span><span class="sd">ready[idx],</span></div>
<div class="l lc d14"><span class="sc">            </span><span class="sd">tokenAddress,</span></div>
<div class="l lc d14"><span class="sc">            </span><span class="sd">target.amountPerPeriod</span></div>
<div class="l lc d14"><span class="sc">          </span><span class="sd">);</span></div>
<div class="l li"><span class="si">        } catch {</span></div>
<div class="l li"><span class="si">          revert RewardTokenError();</span></div>
<div class="l li"><span class="si">        }</span></div>
<div class="l li"><span class="si">      }</span></div>
<div class="l li"><span class="si">    }</span></div>
<div class="l li"><span class="si">  }</span></div>
<div class="l li"></div>
<div class="l li"><span class="si">  /**</span></div>
<div class="l li"><span class="si">   * * @notice This is to allow the owner to manually trigger an injection of funds in place of the keeper</span></div>
<div class="l li"><span class="si">   * @notice without abi encoding the gauge list</span></div>
<div class="l li"><span class="si">   * @param gauges array of gauges to inject tokens to</span></div>
<div class="l li"><span class="si">   */</span></div>
<div class="l li"><span class="si">  function injectFunds(address[] memory gauges) external onlyOwner {</span></div>
<div class="l li"><span class="si">    _injectFunds(gauges);</span></div>
<div class="l li"><span class="si">  }</span></div>
<div class="l li"></div>
<div class="l li"><span class="si">  /**</span></div>
<div class="l li"><span class="si">   * @notice Get list of addresses that are ready for new token injections and return keeper-compatible payload</span></div>
<div class="l li"><span class="si">   * @notice calldata required by the chainlink interface but not used in this case, use 0x</span></div>
<div class="l li"><span class="si">   * @return upkeepNeeded signals if upkeep is needed</span></div>
<div class="l li"><span class="si">   * @return performData is an abi encoded list of addresses that need funds</span></div>
<div class="l li"><span class="si">   */</span></div>
<div class="l lc d15"><span class="sc">  function checkUpkeep(</span></div>
<div class="l lc d15"><span class="sc">    </span><span class="sd">bytes calldata</span></div>
<div class="l lc d15"><span class="sc">  </span><span class="sd">)</span></div>
<div class="l li"><span class="si">    external</span></div>
<div class="l li"><span class="si">    view</span></div>
<div class="l li"><span class="si">    override</span></div>
<div class="l li"><span class="si">    whenNotPaused</span></div>
<div class="l li"><span class="si">    returns (bool upkeepNeeded, bytes memory performData)</span></div>
<div class="l li"><span class="si">  {</span></div>
<div class="l li"><span class="si">    address[] memory ready = getReadyGauges();</span></div>
<div class="l li"><span class="si">    upkeepNeeded = ready.length &gt; 0;</span></div>
<div class="l li"><span class="si">    performData = abi.encode(ready);</span></div>
<div class="l li"><span class="si">    return (upkeepNeeded, performData);</span></div>
<div class="l li"><span class="si">  }</span></div>
<div class="l li"></div>
<div class="l li"><span class="si">  /**</span></div>
<div class="l li"><span class="si">   * @notice Called by keeper to send funds to underfunded addresses</span></div>
<div class="l li"><span class="si">   * @param performData The abi encoded list of addresses to fund</span></div>
<div class="l li"><span class="si">   */</span></div>
<div class="l lc d16"><span class="sc">  function performUpkeep(</span></div>
<div class="l lc d16"><span class="sc">    </span><span class="sd">bytes calldata performData</span></div>
<div class="l lc d16"><span class="sc">  </span><span class="sd">) external override onlyKeeperRegistry whenNotPaused {</span></div>
<div class="l li"><span class="si">    address[] memory needsFunding = abi.decode(performData, (address[]));</span></div>
<div class="l li"><span class="si">    _injectFunds(needsFunding);</span></div>
<div class="l li"><span class="si">    emit PerformedUpkeep(needsFunding);</span></div>
<div class="l li"><span class="si">  }</span></div>
<div class="l li"></div>
<div class="l li"><span class="si">  /**</span></div>
<div class="l li"><span class="si">   * @notice Withdraws the contract balance</span></div>
<div class="l li"><span class="si">   */</span></div>
<div class="l li"><span class="si">  function withdrawGasToken() external onlyOwner {</span></div>
<div class="l li"><span class="si">    address payable recipient = payable(owner());</span></div>
<div class="l li"><span class="si">    if (recipient == address(0)) {</span></div>
<div class="l li"><span class="si">      revert ZeroAddress();</span></div>
<div class="l li"><span class="si">    }</span></div>
<div class="l li"><span class="si">    uint256 amount = address(this).balance;</span></div>
<div class="l li"><span class="si">    recipient.transfer(amount);</span></div>
<div class="l li"><span class="si">    emit GasTokenWithdrawn(amount, recipient);</span></div>
<div class="l li"><span class="si">  }</span></div>
<div class="l li"></div>
<div class="l li"><span class="si">  /**</span></div>
<div class="l li"><span class="si">   * @notice Sweep the full contract's balance for a given ERC-20 token</span></div>
<div class="l li"><span class="si">   * @param token The ERC-20 token which needs to be swept</span></div>
<div class="l li"><span class="si">   */</span></div>
<div class="l li"><span class="si">  function sweep(address token) external onlyOwner {</span></div>
<div class="l li"><span class="si">    uint256 balance = IERC20(token).balanceOf(address(this));</span></div>
<div class="l li"><span class="si">    SafeERC20.safeTransfer(IERC20(token), owner(), balance);</span></div>
<div class="l li"><span class="si">    emit ERC20Swept(token, owner(), balance);</span></div>
<div class="l li"><span class="si">  }</span></div>
<div class="l li"></div>
<div class="l li"></div>
<div class="l li"></div>
<div class="l li"><span class="si">  /**</span></div>
<div class="l li"><span class="si">   * @notice Set distributor from the injector back to the owner.</span></div>
<div class="l li"><span class="si">   * @notice You will have to call set_reward_distributor back to the injector FROM the current distributor if you wish to continue using the injector</span></div>
<div class="l li"><span class="si">   * @notice be aware that the only addresses able to call set_reward_distributor are the current distributor and balancer governance authorized accounts (the LM multisig)</span></div>
<div class="l li"><span class="si">   * @param gauge The Gauge to set distributor for</span></div>
<div class="l li"><span class="si">   * @param reward_token Token you are setting the distributor for</span></div>
<div class="l li"><span class="si">   */</span></div>
<div class="l lc d17"><span class="sc">  function setDistributorToOwner(</span></div>
<div class="l lc d17"><span class="sc">    </span><span class="sd">address gauge,</span></div>
<div class="l lc d17"><span class="sc">    </span><span class="sd">address reward_token</span></div>
<div class="l lc d17"><span class="sc">  </span><span class="sd">) external onlyOwner {</span></div>
<div class="l lc d17"><span class="sc">    </span><span class="sc2">IMainChainGauge</span><span class="sc">(gauge).set_reward_distributor(reward_token, msg.sender);</span></div>
<div class="l li"><span class="si">  }</span></div>
<div class="l li"></div>
<div class="l li"><span class="si">  /**</span></div>
<div class="l li"><span class="si">   * @notice Manually deposit an amount of tokens to the gauge</span></div>
<div class="l li"><span class="si">   * @param gauge The Gauge to set distributor to injector owner</span></div>
<div class="l li"><span class="si">   * @param reward_token Reward token you are seeding</span></div>
<div class="l li"><span class="si">   * @param amount Amount to deposit</span></div>
<div class="l li"><span class="si">   */</span></div>
<div class="l lc d18"><span class="sc">  function manualDeposit(</span></div>
<div class="l lc d18"><span class="sc">    </span><span class="sd">address gauge,</span></div>
<div class="l lc d18"><span class="sc">    </span><span class="sd">address reward_token,</span></div>
<div class="l lc d18"><span class="sc">    </span><span class="sd">uint256 amount</span></div>
<div class="l lc d18"><span class="sc">  </span><span class="sd">) external onlyOwner {</span></div>
<div class="l lc d18"><span class="sc">    </span><span class="sc2">IMainChainGauge</span><span class="sc"> gaugeContract = </span><span class="sc2">IMainChainGauge</span><span class="sc">(gauge);</span></div>
<div class="l li"><span class="si">    IERC20 token = IERC20(reward_token);</span></div>
<div class="l li"><span class="si">    SafeERC20.safeApprove(token, gauge, amount);</span></div>
<div class="l li"><span class="si">    gaugeContract.deposit_reward_token(reward_token, amount);</span></div>
<div class="l li"><span class="si">    emit EmissionsInjection(gauge, reward_token, amount);</span></div>
<div class="l li"><span class="si">  }</span></div>
<div class="l li"></div>
<div class="l li"><span class="si">  /**</span></div>
<div class="l li"><span class="si">   * @notice Sets the keeper registry address</span></div>
<div class="l li"><span class="si">   */</span></div>
<div class="l lc d19"><span class="sc">  function setKeeperRegistryAddress(</span></div>
<div class="l lc d19"><span class="sc">    </span><span class="sd">address keeperRegistryAddress</span></div>
<div class="l lc d19"><span class="sc">  </span><span class="sd">) public onlyOwner {</span></div>
<div class="l li"><span class="si">    s_keeperRegistryAddress = keeperRegistryAddress;</span></div>
<div class="l lc d20"><span class="sc">    emit KeeperRegistryAddressUpdated(</span></div>
<div class="l lc d20"><span class="sc">      </span><span class="sd">s_keeperRegistryAddress,</span></div>
<div class="l lc d20"><span class="sc">      </span><span class="sd">keeperRegistryAddress</span></div>
<div class="l lc d20"><span class="sc">    </span><span class="sd">);</span></div>
<div class="l li"><span class="si">  }</span></div>
<div class="l li"></div>
<div class="l li"><span class="si">  /**</span></div>
<div class="l li"><span class="si">   * @notice Sets the minimum wait period (in seconds) for addresses between injections</span></div>
<div class="l li"><span class="si">   */</span></div>
<div class="l li"><span class="si">  function setMinWaitPeriodSeconds(uint256 period) public onlyOwner {</span></div>
<div class="l li"><span class="si">    s_minWaitPeriodSeconds = period;</span></div>
<div class="l li"><span class="si">    emit MinWaitPeriodUpdated(s_minWaitPeriodSeconds, period);</span></div>
<div class="l li"><span class="si">  }</span></div>
<div class="l li"></div>
<div class="l li"><span class="si">  /**</span></div>
<div class="l li"><span class="si">   * @notice Gets the keeper registry address</span></div>
<div class="l li"><span class="si">   */</span></div>
<div class="l lc d21"><span class="sc">  function getKeeperRegistryAddress()</span></div>
<div class="l lc d21"><span class="sc">    </span><span class="sd">external</span></div>
<div class="l lc d21"><span class="sc">    </span><span class="sd">view</span></div>
<div class="l lc d21"><span class="sc">    </span><span class="sd">returns (address keeperRegistryAddress)</span></div>
<div class="l lc d21"><span class="sc">  </span><span class="sd">{</span></div>
<div class="l li"><span class="si">    return s_keeperRegistryAddress;</span></div>
<div class="l li"><span class="si">  }</span></div>
<div class="l li"></div>
<div class="l li"><span class="si">  /**</span></div>
<div class="l li"><span class="si">   * @notice Gets the minimum wait period</span></div>
<div class="l li"><span class="si">   */</span></div>
<div class="l li"><span class="si">  function getMinWaitPeriodSeconds() external view returns (uint256) {</span></div>
<div class="l li"><span class="si">    return s_minWaitPeriodSeconds;</span></div>
<div class="l li"><span class="si">  }</span></div>
<div class="l li"></div>
<div class="l li"><span class="si">  /**</span></div>
<div class="l li"><span class="si">   * @notice Gets the list of addresses on the in the current configuration.</span></div>
<div class="l li"><span class="si">   */</span></div>
<div class="l li"><span class="si">  function getWatchList() external view returns (address[] memory) {</span></div>
<div class="l li"><span class="si">    return s_gaugeList;</span></div>
<div class="l li"><span class="si">  }</span></div>
<div class="l li"></div>
<div class="l li"><span class="si">  /**</span></div>
<div class="l li"><span class="si">   * @notice Sets the address of the ERC20 token this contract should handle</span></div>
<div class="l li"><span class="si">   */</span></div>
<div class="l li"><span class="si">  function setInjectTokenAddress(address ERC20token) public onlyOwner {</span></div>
<div class="l li"><span class="si">    s_injectTokenAddress = ERC20token;</span></div>
<div class="l li"><span class="si">    emit SetHandlingToken(ERC20token);</span></div>
<div class="l li"><span class="si">  }</span></div>
<div class="l li"><span class="si">  /**</span></div>
<div class="l li"><span class="si">   * @notice Gets the token this injector is operating on</span></div>
<div class="l li"><span class="si">   */</span></div>
<div class="l lg"></div>
<div class="l li"><span class="si">  function getInjectTokenAddress() external view returns (address) {</span></div>
<div class="l li"><span class="si">    return s_injectTokenAddress;</span></div>
<div class="l li"><span class="si">  }</span></div>
<div class="l li"><span class="si">  /**</span></div>
<div class="l li"><span class="si">   * @notice Gets configuration information for an address on the gaugelist</span></div>
<div class="l li"><span class="si">   * @param targetAddress return Target struct for a given gauge according to the current scheduled distributions</span></div>
<div class="l li"><span class="si">   */</span></div>
<div class="l lg"></div>
<div class="l lc d22"><span class="sc">  function getAccountInfo(</span></div>
<div class="l lc d22"><span class="sc">    </span><span class="sd">address targetAddress</span></div>
<div class="l lc d22"><span class="sc">  </span><span class="sd">)</span></div>
<div class="l li"><span class="si">    external</span></div>
<div class="l li"><span class="si">    view</span></div>
<div class="l li"><span class="si">    returns (</span></div>
<div class="l li"><span class="si">      uint256 amountPerPeriod,</span></div>
<div class="l li"><span class="si">      bool isActive,</span></div>
<div class="l li"><span class="si">      uint8 maxPeriods,</span></div>
<div class="l li"><span class="si">      uint8 periodNumber,</span></div>
<div class="l li"><span class="si">      uint56 lastInjectionTimeStamp</span></div>
<div class="l li"><span class="si">    )</span></div>
<div class="l li"><span class="si">  {</span></div>
<div class="l li"><span class="si">    Target memory target = s_targets[targetAddress];</span></div>
<div class="l lc d23"><span class="sc">    return (</span></div>
<div class="l lc d23"><span class="sc">      </span><span class="sd">target.amountPerPeriod,</span></div>
<div class="l lc d23"><span class="sc">      </span><span class="sd">target.isActive,</span></div>
<div class="l lc d23"><span class="sc">      </span><span class="sd">target.maxPeriods,</span></div>
<div class="l lc d23"><span class="sc">      </span><span class="sd">target.periodNumber,</span></div>
<div class="l lc d23"><span class="sc">      </span><span class="sd">target.lastInjectionTimeStamp</span></div>
<div class="l lc d23"><span class="sc">    </span><span class="sd">);</span></div>
<div class="l li"><span class="si">  }</span></div>
<div class="l li"></div>
<div class="l li"><span class="si">  /**</span></div>
<div class="l li"><span class="si">   * @notice Pauses the contract, which prevents executing performUpkeep</span></div>
<div class="l li"><span class="si">   */</span></div>
<div class="l li"><span class="si">  function pause() external onlyOwner {</span></div>
<div class="l li"><span class="si">    _pause();</span></div>
<div class="l li"><span class="si">  }</span></div>
<div class="l li"></div>
<div class="l li"><span class="si">  /**</span></div>
<div class="l li"><span class="si">   * @notice Unpauses the contract</span></div>
<div class="l li"><span class="si">   */</span></div>
<div class="l li"><span class="si">  function unpause() external onlyOwner {</span></div>
<div class="l li"><span class="si">    _unpause();</span></div>
<div class="l li"><span class="si">  }</span></div>
<div class="l li"></div>
<div class="l li"><span class="si">  /**</span></div>
<div class="l li"><span class="si">   * @notice takes in a list of addresses and reverts if there is a duplicate</span></div>
<div class="l li"><span class="si">   */</span></div>
<div class="l li"><span class="si">  function revertOnDuplicate(address[] memory list) internal pure {</span></div>
<div class="l li"><span class="si">    uint256 length = list.length;</span></div>
<div class="l li"><span class="si">    if (length == 0) {</span></div>
<div class="l li"><span class="si">      return;</span></div>
<div class="l li"><span class="si">    }</span></div>
<div class="l li"><span class="si">    for (uint256 i = 0; i &lt; length - 1; i++) {</span></div>
<div class="l li"><span class="si">      for (uint256 j = i + 1; j &lt; length; j++) {</span></div>
<div class="l li"><span class="si">        if (list[i] == list[j]) {</span></div>
<div class="l li"><span class="si">          revert DuplicateAddress(list[i]);</span></div>
<div class="l li"><span class="si">        }</span></div>
<div class="l li"><span class="si">      }</span></div>
<div class="l li"><span class="si">    }</span></div>
<div class="l li"><span class="si">    // No duplicates found</span></div>
<div class="l li"><span class="si">  }</span></div>
<div class="l li"></div>
<div class="l li"><span class="si">  modifier onlyKeeperRegistry() {</span></div>
<div class="l li"><span class="si">    if (msg.sender != s_keeperRegistryAddress) {</span></div>
<div class="l li"><span class="si">      revert OnlyKeeperRegistry(msg.sender);</span></div>
<div class="l li"><span class="si">    }</span></div>
<div class="l li"><span class="si">    _;</span></div>
<div class="l li"><span class="si">  }</span></div>
<div class="l li"><span class="si">}</span></div>
<div class="l li"></div>

                            </td>
                        </tr>
                    </table>
                </div>
            </div>
            <div id="pane2" class="pane" style="">
                <div id="title2" class="title" style="" title="https://raw.githubusercontent.com/BalancerMaxis/ChildChainGaugeInjectoooor/main/contracts/ChildChainGaugeInjectoooor.sol">https://raw.githubusercontent.com/BalancerMaxis/ChildChainGaugeInjectoooor/main/contracts/ChildChainGaugeInjectoooor.sol</div>
                <div id="file2" class="file" style=" ">
                    <table class="panes">
                        <tr>
                            <td class="diffBar" style="display: none;">
                                <div class="diffs"></div>
                            </td>
                            <td class="nums">
                                <div class="num">  1 </div>
<div class="num">  2 </div>
<div class="num">  3 </div>
<div class="num">  4 </div>
<div class="num">  5 </div>
<div class="num">  6 </div>
<div class="num">  7 </div>
<div class="num">  8 </div>
<div class="num">  9 </div>
<div class="num"> 10 </div>
<div class="num"> 11 </div>
<div class="num"> 12 </div>
<div class="num"> 13 </div>
<div class="num"> 14 </div>
<div class="num"> 15 </div>
<div class="num"> 16 </div>
<div class="num"> 17 </div>
<div class="num"> 18 </div>
<div class="num"> 19 </div>
<div class="num"> 20 </div>
<div class="num"> 21 </div>
<div class="num">    </div>
<div class="num"> 22 </div>
<div class="num"> 23 </div>
<div class="num"> 24 </div>
<div class="num">    </div>
<div class="num">    </div>
<div class="num">    </div>
<div class="num">    </div>
<div class="num"> 25 </div>
<div class="num"> 26 </div>
<div class="num"> 27 </div>
<div class="num">    </div>
<div class="num">    </div>
<div class="num">    </div>
<div class="num"> 28 </div>
<div class="num"> 29 </div>
<div class="num"> 30 </div>
<div class="num"> 31 </div>
<div class="num"> 32 </div>
<div class="num"> 33 </div>
<div class="num"> 34 </div>
<div class="num"> 35 </div>
<div class="num"> 36 </div>
<div class="num"> 37 </div>
<div class="num"> 38 </div>
<div class="num"> 39 </div>
<div class="num"> 40 </div>
<div class="num"> 41 </div>
<div class="num"> 42 </div>
<div class="num"> 43 </div>
<div class="num"> 44 </div>
<div class="num"> 45 </div>
<div class="num"> 46 </div>
<div class="num"> 47 </div>
<div class="num"> 48 </div>
<div class="num"> 49 </div>
<div class="num"> 50 </div>
<div class="num"> 51 </div>
<div class="num"> 52 </div>
<div class="num"> 53 </div>
<div class="num"> 54 </div>
<div class="num"> 55 </div>
<div class="num"> 56 </div>
<div class="num"> 57 </div>
<div class="num"> 58 </div>
<div class="num"> 59 </div>
<div class="num"> 60 </div>
<div class="num"> 61 </div>
<div class="num"> 62 </div>
<div class="num"> 63 </div>
<div class="num"> 64 </div>
<div class="num">    </div>
<div class="num">    </div>
<div class="num"> 65 </div>
<div class="num"> 66 </div>
<div class="num"> 67 </div>
<div class="num"> 68 </div>
<div class="num"> 69 </div>
<div class="num"> 70 </div>
<div class="num"> 71 </div>
<div class="num"> 72 </div>
<div class="num"> 73 </div>
<div class="num"> 74 </div>
<div class="num"> 75 </div>
<div class="num"> 76 </div>
<div class="num"> 77 </div>
<div class="num"> 78 </div>
<div class="num"> 79 </div>
<div class="num"> 80 </div>
<div class="num"> 81 </div>
<div class="num">    </div>
<div class="num">    </div>
<div class="num">    </div>
<div class="num"> 82 </div>
<div class="num"> 83 </div>
<div class="num"> 84 </div>
<div class="num"> 85 </div>
<div class="num"> 86 </div>
<div class="num"> 87 </div>
<div class="num"> 88 </div>
<div class="num"> 89 </div>
<div class="num"> 90 </div>
<div class="num"> 91 </div>
<div class="num"> 92 </div>
<div class="num"> 93 </div>
<div class="num"> 94 </div>
<div class="num"> 95 </div>
<div class="num"> 96 </div>
<div class="num"> 97 </div>
<div class="num"> 98 </div>
<div class="num"> 99 </div>
<div class="num">100 </div>
<div class="num">101 </div>
<div class="num">102 </div>
<div class="num">103 </div>
<div class="num">104 </div>
<div class="num">105 </div>
<div class="num">106 </div>
<div class="num">107 </div>
<div class="num">108 </div>
<div class="num">109 </div>
<div class="num">110 </div>
<div class="num">111 </div>
<div class="num">112 </div>
<div class="num">113 </div>
<div class="num">114 </div>
<div class="num">115 </div>
<div class="num">116 </div>
<div class="num">117 </div>
<div class="num">118 </div>
<div class="num">119 </div>
<div class="num">120 </div>
<div class="num">121 </div>
<div class="num">122 </div>
<div class="num">123 </div>
<div class="num">124 </div>
<div class="num">125 </div>
<div class="num">126 </div>
<div class="num">127 </div>
<div class="num">128 </div>
<div class="num">129 </div>
<div class="num">130 </div>
<div class="num">131 </div>
<div class="num">132 </div>
<div class="num">133 </div>
<div class="num">134 </div>
<div class="num">135 </div>
<div class="num">136 </div>
<div class="num">137 </div>
<div class="num">138 </div>
<div class="num">139 </div>
<div class="num">140 </div>
<div class="num">141 </div>
<div class="num">142 </div>
<div class="num">143 </div>
<div class="num">144 </div>
<div class="num">145 </div>
<div class="num">146 </div>
<div class="num">147 </div>
<div class="num">    </div>
<div class="num">    </div>
<div class="num">148 </div>
<div class="num">149 </div>
<div class="num">150 </div>
<div class="num">151 </div>
<div class="num">152 </div>
<div class="num">153 </div>
<div class="num">154 </div>
<div class="num">155 </div>
<div class="num">156 </div>
<div class="num">157 </div>
<div class="num">158 </div>
<div class="num">159 </div>
<div class="num">160 </div>
<div class="num">161 </div>
<div class="num">162 </div>
<div class="num">163 </div>
<div class="num">164 </div>
<div class="num">165 </div>
<div class="num">166 </div>
<div class="num">167 </div>
<div class="num">168 </div>
<div class="num">169 </div>
<div class="num">170 </div>
<div class="num">171 </div>
<div class="num">172 </div>
<div class="num">173 </div>
<div class="num">174 </div>
<div class="num">175 </div>
<div class="num">176 </div>
<div class="num">177 </div>
<div class="num">178 </div>
<div class="num">179 </div>
<div class="num">180 </div>
<div class="num">181 </div>
<div class="num">182 </div>
<div class="num">183 </div>
<div class="num">184 </div>
<div class="num">185 </div>
<div class="num">186 </div>
<div class="num">187 </div>
<div class="num">188 </div>
<div class="num">189 </div>
<div class="num">190 </div>
<div class="num">191 </div>
<div class="num">192 </div>
<div class="num">193 </div>
<div class="num">194 </div>
<div class="num">195 </div>
<div class="num">196 </div>
<div class="num">197 </div>
<div class="num">198 </div>
<div class="num">199 </div>
<div class="num">200 </div>
<div class="num">201 </div>
<div class="num">202 </div>
<div class="num">203 </div>
<div class="num">204 </div>
<div class="num">205 </div>
<div class="num">206 </div>
<div class="num">207 </div>
<div class="num">208 </div>
<div class="num">209 </div>
<div class="num">210 </div>
<div class="num">211 </div>
<div class="num">    </div>
<div class="num">212 </div>
<div class="num">213 </div>
<div class="num">214 </div>
<div class="num">215 </div>
<div class="num">216 </div>
<div class="num">217 </div>
<div class="num">218 </div>
<div class="num">219 </div>
<div class="num">220 </div>
<div class="num">    </div>
<div class="num">    </div>
<div class="num">    </div>
<div class="num">    </div>
<div class="num">    </div>
<div class="num">221 </div>
<div class="num">    </div>
<div class="num">    </div>
<div class="num">222 </div>
<div class="num">223 </div>
<div class="num">    </div>
<div class="num">    </div>
<div class="num">    </div>
<div class="num">    </div>
<div class="num">224 </div>
<div class="num">225 </div>
<div class="num">226 </div>
<div class="num">227 </div>
<div class="num">228 </div>
<div class="num">229 </div>
<div class="num">230 </div>
<div class="num">231 </div>
<div class="num">232 </div>
<div class="num">233 </div>
<div class="num">234 </div>
<div class="num">235 </div>
<div class="num">236 </div>
<div class="num">237 </div>
<div class="num">238 </div>
<div class="num">239 </div>
<div class="num">240 </div>
<div class="num">241 </div>
<div class="num">242 </div>
<div class="num">243 </div>
<div class="num">244 </div>
<div class="num">245 </div>
<div class="num">246 </div>
<div class="num">    </div>
<div class="num">    </div>
<div class="num">247 </div>
<div class="num">248 </div>
<div class="num">249 </div>
<div class="num">250 </div>
<div class="num">251 </div>
<div class="num">252 </div>
<div class="num">253 </div>
<div class="num">254 </div>
<div class="num">255 </div>
<div class="num">256 </div>
<div class="num">257 </div>
<div class="num">258 </div>
<div class="num">259 </div>
<div class="num">260 </div>
<div class="num">261 </div>
<div class="num">262 </div>
<div class="num">263 </div>
<div class="num">    </div>
<div class="num">    </div>
<div class="num">264 </div>
<div class="num">265 </div>
<div class="num">266 </div>
<div class="num">267 </div>
<div class="num">268 </div>
<div class="num">269 </div>
<div class="num">270 </div>
<div class="num">271 </div>
<div class="num">272 </div>
<div class="num">273 </div>
<div class="num">274 </div>
<div class="num">275 </div>
<div class="num">276 </div>
<div class="num">277 </div>
<div class="num">278 </div>
<div class="num">279 </div>
<div class="num">280 </div>
<div class="num">281 </div>
<div class="num">282 </div>
<div class="num">283 </div>
<div class="num">284 </div>
<div class="num">285 </div>
<div class="num">286 </div>
<div class="num">287 </div>
<div class="num">288 </div>
<div class="num">289 </div>
<div class="num">290 </div>
<div class="num">291 </div>
<div class="num">292 </div>
<div class="num">293 </div>
<div class="num">294 </div>
<div class="num">295 </div>
<div class="num">296 </div>
<div class="num">297 </div>
<div class="num">298 </div>
<div class="num">299 </div>
<div class="num">300 </div>
<div class="num">301 </div>
<div class="num">    </div>
<div class="num">    </div>
<div class="num">    </div>
<div class="num">302 </div>
<div class="num">303 </div>
<div class="num">304 </div>
<div class="num">305 </div>
<div class="num">306 </div>
<div class="num">307 </div>
<div class="num">308 </div>
<div class="num">309 </div>
<div class="num">310 </div>
<div class="num">311 </div>
<div class="num">    </div>
<div class="num">    </div>
<div class="num">    </div>
<div class="num">    </div>
<div class="num">312 </div>
<div class="num">313 </div>
<div class="num">314 </div>
<div class="num">315 </div>
<div class="num">316 </div>
<div class="num">317 </div>
<div class="num">318 </div>
<div class="num">319 </div>
<div class="num">320 </div>
<div class="num">321 </div>
<div class="num">322 </div>
<div class="num">    </div>
<div class="num">    </div>
<div class="num">323 </div>
<div class="num">324 </div>
<div class="num">    </div>
<div class="num">    </div>
<div class="num">    </div>
<div class="num">325 </div>
<div class="num">326 </div>
<div class="num">327 </div>
<div class="num">328 </div>
<div class="num">329 </div>
<div class="num">330 </div>
<div class="num">331 </div>
<div class="num">332 </div>
<div class="num">333 </div>
<div class="num">334 </div>
<div class="num">335 </div>
<div class="num">336 </div>
<div class="num">337 </div>
<div class="num">338 </div>
<div class="num">    </div>
<div class="num">    </div>
<div class="num">    </div>
<div class="num">    </div>
<div class="num">339 </div>
<div class="num">340 </div>
<div class="num">341 </div>
<div class="num">342 </div>
<div class="num">343 </div>
<div class="num">344 </div>
<div class="num">345 </div>
<div class="num">346 </div>
<div class="num">347 </div>
<div class="num">348 </div>
<div class="num">349 </div>
<div class="num">350 </div>
<div class="num">351 </div>
<div class="num">352 </div>
<div class="num">353 </div>
<div class="num">354 </div>
<div class="num">355 </div>
<div class="num">356 </div>
<div class="num">357 </div>
<div class="num">358 </div>
<div class="num">359 </div>
<div class="num">360 </div>
<div class="num">361 </div>
<div class="num">362 </div>
<div class="num">363 </div>
<div class="num">364 </div>
<div class="num">365 </div>
<div class="num">    </div>
<div class="num">366 </div>
<div class="num">367 </div>
<div class="num">368 </div>
<div class="num">369 </div>
<div class="num">370 </div>
<div class="num">371 </div>
<div class="num">372 </div>
<div class="num">    </div>
<div class="num">373 </div>
<div class="num">    </div>
<div class="num">    </div>
<div class="num">374 </div>
<div class="num">375 </div>
<div class="num">376 </div>
<div class="num">377 </div>
<div class="num">378 </div>
<div class="num">379 </div>
<div class="num">380 </div>
<div class="num">381 </div>
<div class="num">382 </div>
<div class="num">383 </div>
<div class="num">384 </div>
<div class="num">385 </div>
<div class="num">    </div>
<div class="num">    </div>
<div class="num">    </div>
<div class="num">    </div>
<div class="num">    </div>
<div class="num">    </div>
<div class="num">386 </div>
<div class="num">387 </div>
<div class="num">388 </div>
<div class="num">389 </div>
<div class="num">390 </div>
<div class="num">391 </div>
<div class="num">392 </div>
<div class="num">393 </div>
<div class="num">394 </div>
<div class="num">395 </div>
<div class="num">396 </div>
<div class="num">397 </div>
<div class="num">398 </div>
<div class="num">399 </div>
<div class="num">400 </div>
<div class="num">401 </div>
<div class="num">402 </div>
<div class="num">403 </div>
<div class="num">404 </div>
<div class="num">405 </div>
<div class="num">406 </div>
<div class="num">407 </div>
<div class="num">408 </div>
<div class="num">409 </div>
<div class="num">410 </div>
<div class="num">411 </div>
<div class="num">412 </div>
<div class="num">413 </div>
<div class="num">414 </div>
<div class="num">415 </div>
<div class="num">416 </div>
<div class="num">417 </div>
<div class="num">418 </div>
<div class="num">419 </div>
<div class="num">420 </div>
<div class="num">421 </div>
<div class="num">422 </div>
<div class="num">423 </div>
<div class="num">424 </div>
<div class="num">425 </div>
<div class="num">426 </div>
<div class="num">427 </div>

                            </td>
                            <td class="content">
                                <div class="l li"><span class="si">// SPDX-License-Identifier: MIT</span></div>
<div class="l li"></div>
<div class="l li"><span class="si">pragma solidity ^0.8.18;</span></div>
<div class="l li"></div>
<div class="l li"><span class="si">import &quot;@chainlink/contracts/src/v0.8/ConfirmedOwner.sol&quot;;</span></div>
<div class="l li"><span class="si">import &quot;@chainlink/contracts/src/v0.8/interfaces/KeeperCompatibleInterface.sol&quot;;</span></div>
<div class="l li"><span class="si">import &quot;@openzeppelin/contracts/security/Pausable.sol&quot;;</span></div>
<div class="l li"><span class="si">import &quot;@openzeppelin/contracts/token/ERC20/utils/SafeERC20.sol&quot;;</span></div>
<div class="l li"><span class="si">import &quot;@openzeppelin/contracts/token/ERC20/IERC20.sol&quot;;</span></div>
<div class="l lc d1"><span class="sc">import &quot;interfaces/</span><span class="sa">balancer/</span><span class="sc2">IChildChainGauge</span><span class="sc">.sol&quot;;</span></div>
<div class="l li"></div>
<div class="l lg"></div>
<div class="l li"><span class="si">/**</span></div>
<div class="l lc d2"><span class="sc"> * @title The </span><span class="sc2">ChildChainGaugeInjector</span><span class="sc"> Contract</span></div>
<div class="l li"><span class="si"> * @author 0xtritium.eth + master coder Mike B</span></div>
<div class="l li"><span class="si"> * @notice This contract is a chainlink automation compatible interface to automate regular payment of non-BAL tokens to a child chain gauge.</span></div>
<div class="l li"><span class="si"> * @notice This contract is meant to run/manage a single token.  This is almost always the case for a DAO trying to use such a thing.</span></div>
<div class="l li"><span class="si"> * @notice The configuration is rewritten each time it is loaded.</span></div>
<div class="l li"><span class="si"> * @notice This contract will only function if it is configured as the distributor for a token/gauge it is operating on.</span></div>
<div class="l li"><span class="si"> * @notice The contract is meant to hold token balances, and works on a schedule set using setRecipientList.  The schedule defines an amount per round and number of rounds per gauge.</span></div>
<div class="l li"><span class="si"> * @notice This contract is Ownable and has lots of sweep functionality to allow the owner to work with the contract or get tokens out should there be a problem.</span></div>
<div class="l ld d3"></div>
<div class="l li"><span class="si"> * see https://docs.chain.link/chainlink-automation/utility-contracts/</span></div>
<div class="l li"><span class="si"> */</span></div>
<div class="l lc d4"><span class="sc">contract </span><span class="sc2">ChildChainGaugeInjector</span><span class="sc"> is </span><span class="sa">ConfirmedOwner, Pausable, KeeperCompatibleInterface {</span></div>
<div class="l lc d4"></div>
<div class="l lc d4"></div>
<div class="l lc d4"></div>
<div class="l lc d4"></div>
<div class="l li"><span class="si">    event GasTokenWithdrawn(uint256 amountWithdrawn, address recipient);</span></div>
<div class="l li"><span class="si">    event KeeperRegistryAddressUpdated(address oldAddress, address newAddress);</span></div>
<div class="l lc d5"><span class="sc">    event MinWaitPeriodUpdated(</span><span class="sa">uint256 oldMinWaitPeriod, uint256 newMinWaitPeriod);</span></div>
<div class="l lc d5"></div>
<div class="l lc d5"></div>
<div class="l lc d5"></div>
<div class="l li"><span class="si">    event ERC20Swept(address indexed token, address recipient, uint256 amount);</span></div>
<div class="l li"><span class="si">    event EmissionsInjection(address gauge, address token, uint256 amount);</span></div>
<div class="l li"><span class="si">    event SetHandlingToken(address token);</span></div>
<div class="l li"><span class="si">    event PerformedUpkeep(address[] needsFunding);</span></div>
<div class="l li"></div>
<div class="l li"><span class="si">    error ListLengthMismatch();</span></div>
<div class="l li"><span class="si">    error OnlyKeeperRegistry(address sender);</span></div>
<div class="l li"><span class="si">    error DuplicateAddress(address duplicate);</span></div>
<div class="l li"><span class="si">    error PeriodNotFinished(uint256 periodNumber, uint256 maxPeriods);</span></div>
<div class="l li"><span class="si">    error ZeroAddress();</span></div>
<div class="l li"><span class="si">    error ZeroAmount();</span></div>
<div class="l li"><span class="si">    error BalancesMismatch();</span></div>
<div class="l li"><span class="si">    error RewardTokenError();</span></div>
<div class="l li"></div>
<div class="l li"><span class="si">    struct Target {</span></div>
<div class="l li"><span class="si">        uint256 amountPerPeriod;</span></div>
<div class="l li"><span class="si">        bool isActive;</span></div>
<div class="l li"><span class="si">        uint8 maxPeriods;</span></div>
<div class="l li"><span class="si">        uint8 periodNumber;</span></div>
<div class="l li"><span class="si">        uint56 lastInjectionTimeStamp; // enough space for 2 trillion years</span></div>
<div class="l li"><span class="si">    }</span></div>
<div class="l li"></div>
<div class="l lg"></div>
<div class="l li"><span class="si">    address private s_keeperRegistryAddress;</span></div>
<div class="l li"><span class="si">    uint256 private s_minWaitPeriodSeconds;</span></div>
<div class="l li"><span class="si">    address[] private s_gaugeList;</span></div>
<div class="l li"><span class="si">    mapping(address =&gt; Target) internal s_targets;</span></div>
<div class="l li"><span class="si">    address private s_injectTokenAddress;</span></div>
<div class="l li"></div>
<div class="l li"><span class="si">    /**</span></div>
<div class="l li"><span class="si">  * @param keeperRegistryAddress The address of the keeper registry contract</span></div>
<div class="l li"><span class="si">   * @param minWaitPeriodSeconds The minimum wait period for address between funding (for security)</span></div>
<div class="l li"><span class="si">   * @param injectTokenAddress The ERC20 token this contract should mange</span></div>
<div class="l li"><span class="si">   */</span></div>
<div class="l lc d6"><span class="sc">    constructor(</span><span class="sa">address keeperRegistryAddress, uint256 minWaitPeriodSeconds, address injectTokenAddress)</span></div>
<div class="l lc d6"><span class="sc">    </span><span class="sc2">ConfirmedOwner(msg.sender)</span></div>
<div class="l lc d6"><span class="sc">    </span><span class="sc2">{</span></div>
<div class="l lc d6"></div>
<div class="l lc d6"></div>
<div class="l li"><span class="si">        setKeeperRegistryAddress(keeperRegistryAddress);</span></div>
<div class="l li"><span class="si">        setMinWaitPeriodSeconds(minWaitPeriodSeconds);</span></div>
<div class="l li"><span class="si">        setInjectTokenAddress(injectTokenAddress);</span></div>
<div class="l li"><span class="si">    }</span></div>
<div class="l li"></div>
<div class="l li"><span class="si">    /**</span></div>
<div class="l li"><span class="si">   * @notice Sets the list of addresses to watch and their funding parameters</span></div>
<div class="l li"><span class="si">   * @param gaugeAddresses the list of addresses to watch</span></div>
<div class="l li"><span class="si">   * @param amountsPerPeriod the minimum balances for each address</span></div>
<div class="l li"><span class="si">   * @param maxPeriods the amount to top up each address</span></div>
<div class="l li"><span class="si">   */</span></div>
<div class="l li"><span class="si">    function setRecipientList(</span></div>
<div class="l li"><span class="si">        address[] calldata gaugeAddresses,</span></div>
<div class="l li"><span class="si">        uint256[] calldata amountsPerPeriod,</span></div>
<div class="l li"><span class="si">        uint8[] calldata maxPeriods</span></div>
<div class="l li"><span class="si">    ) public onlyOwner {</span></div>
<div class="l lc d7"><span class="sc">        if (</span><span class="sa">gaugeAddresses.length != amountsPerPeriod.length || gaugeAddresses.length != maxPeriods.length) {</span></div>
<div class="l lc d7"></div>
<div class="l lc d7"></div>
<div class="l lc d7"></div>
<div class="l li"><span class="si">            revert ListLengthMismatch();</span></div>
<div class="l li"><span class="si">        }</span></div>
<div class="l li"><span class="si">        revertOnDuplicate(gaugeAddresses);</span></div>
<div class="l li"><span class="si">        address[] memory oldGaugeList = s_gaugeList;</span></div>
<div class="l li"><span class="si">        for (uint256 idx = 0; idx &lt; oldGaugeList.length; idx++) {</span></div>
<div class="l li"><span class="si">            s_targets[oldGaugeList[idx]].isActive = false;</span></div>
<div class="l li"><span class="si">        }</span></div>
<div class="l li"><span class="si">        for (uint256 idx = 0; idx &lt; gaugeAddresses.length; idx++) {</span></div>
<div class="l lg"></div>
<div class="l li"><span class="si">            if (gaugeAddresses[idx] == address(0)) {</span></div>
<div class="l li"><span class="si">                revert ZeroAddress();</span></div>
<div class="l li"><span class="si">            }</span></div>
<div class="l li"><span class="si">            if (amountsPerPeriod[idx] == 0) {</span></div>
<div class="l li"><span class="si">                revert ZeroAmount();</span></div>
<div class="l li"><span class="si">            }</span></div>
<div class="l li"><span class="si">            s_targets[gaugeAddresses[idx]] = Target({</span></div>
<div class="l li"><span class="si">                isActive: true,</span></div>
<div class="l li"><span class="si">                amountPerPeriod: amountsPerPeriod[idx],</span></div>
<div class="l li"><span class="si">                maxPeriods: maxPeriods[idx],</span></div>
<div class="l li"><span class="si">                lastInjectionTimeStamp: 0,</span></div>
<div class="l li"><span class="si">                periodNumber: 0</span></div>
<div class="l li"><span class="si">            });</span></div>
<div class="l li"><span class="si">        }</span></div>
<div class="l li"><span class="si">        s_gaugeList = gaugeAddresses;</span></div>
<div class="l li"><span class="si">    }</span></div>
<div class="l li"></div>
<div class="l li"><span class="si">    /**</span></div>
<div class="l li"><span class="si">     * @notice Validate that all periods are finished, and that the supplied schedule has enough tokens to fully execute</span></div>
<div class="l li"><span class="si">     * @notice If everything checks out, update recipient list, otherwise, throw revert</span></div>
<div class="l li"><span class="si">     * @notice you can use setRecipientList to set a list without validation</span></div>
<div class="l li"><span class="si">     * @param gaugeAddresses : list of gauge addresses</span></div>
<div class="l li"><span class="si">     * @param amountsPerPeriod : list of amount of token in wei to be injected each week</span></div>
<div class="l li"><span class="si">   */</span></div>
<div class="l li"><span class="si">    function setValidatedRecipientList(</span></div>
<div class="l li"><span class="si">        address[] calldata gaugeAddresses,</span></div>
<div class="l li"><span class="si">        uint256[] calldata amountsPerPeriod,</span></div>
<div class="l li"><span class="si">        uint8[] calldata maxPeriods</span></div>
<div class="l li"><span class="si">    ) external onlyOwner {</span></div>
<div class="l li"><span class="si">        address[] memory gaugeList = s_gaugeList;</span></div>
<div class="l li"><span class="si">        // validate all periods are finished</span></div>
<div class="l li"><span class="si">        for (uint256 idx = 0; idx &lt; gaugeList.length; idx++) {</span></div>
<div class="l li"><span class="si">            Target memory target = s_targets[gaugeList[idx]];</span></div>
<div class="l li"><span class="si">            if (target.periodNumber &lt; target.maxPeriods) {</span></div>
<div class="l li"><span class="si">                revert PeriodNotFinished(target.periodNumber, target.maxPeriods);</span></div>
<div class="l li"><span class="si">            }</span></div>
<div class="l li"><span class="si">        }</span></div>
<div class="l li"><span class="si">        setRecipientList(gaugeAddresses, amountsPerPeriod, maxPeriods);</span></div>
<div class="l li"></div>
<div class="l li"><span class="si">        if (!checkSufficientBalances()) {</span></div>
<div class="l li"><span class="si">            revert BalancesMismatch();</span></div>
<div class="l li"><span class="si">        }</span></div>
<div class="l li"><span class="si">    }</span></div>
<div class="l li"></div>
<div class="l li"><span class="si">    /**</span></div>
<div class="l li"><span class="si">   * @notice Validate that the contract holds enough tokens to fulfill the current schedule</span></div>
<div class="l li"><span class="si">   * @return bool true if balance of contract matches scheduled periods</span></div>
<div class="l li"><span class="si">   */</span></div>
<div class="l li"><span class="si">    function checkSufficientBalances() public view returns (bool){</span></div>
<div class="l li"><span class="si">        // iterates through all gauges to make sure there are enough tokens in the contract to fulfill all scheduled tasks</span></div>
<div class="l li"><span class="si">        // (maxperiods - periodnumber) * amountPerPeriod ==  token.balanceOf(address(this))</span></div>
<div class="l li"></div>
<div class="l li"><span class="si">        address[] memory gaugeList = s_gaugeList;</span></div>
<div class="l li"><span class="si">        uint256 totalDue;</span></div>
<div class="l li"><span class="si">        for (uint256 idx = 0; idx &lt; gaugeList.length; idx++) {</span></div>
<div class="l li"><span class="si">            Target memory target = s_targets[gaugeList[idx]];</span></div>
<div class="l lc d8"><span class="sc">            totalDue += </span><span class="sa">(target.maxPeriods - target.periodNumber) * target.amountPerPeriod;</span></div>
<div class="l lc d8"></div>
<div class="l lc d8"></div>
<div class="l li"><span class="si">        }</span></div>
<div class="l li"><span class="si">        return totalDue &lt;= IERC20(s_injectTokenAddress).balanceOf(address(this));</span></div>
<div class="l li"><span class="si">    }</span></div>
<div class="l li"></div>
<div class="l li"><span class="si">    /**</span></div>
<div class="l li"><span class="si">   * @notice Gets a list of addresses that are ready to inject</span></div>
<div class="l li"><span class="si">   * @notice This is done by checking if the current period has ended, and should inject new funds directly after the end of each period.</span></div>
<div class="l li"><span class="si">   * @return list of addresses that are ready to inject</span></div>
<div class="l li"><span class="si">   */</span></div>
<div class="l li"><span class="si">    function getReadyGauges() public view returns (address[] memory) {</span></div>
<div class="l li"><span class="si">        address[] memory gaugeList = s_gaugeList;</span></div>
<div class="l li"><span class="si">        address[] memory ready = new address[](gaugeList.length);</span></div>
<div class="l li"><span class="si">        address tokenAddress = s_injectTokenAddress;</span></div>
<div class="l li"><span class="si">        uint256 count = 0;</span></div>
<div class="l li"><span class="si">        uint256 minWaitPeriod = s_minWaitPeriodSeconds;</span></div>
<div class="l li"><span class="si">        uint256 balance = IERC20(tokenAddress).balanceOf(address(this));</span></div>
<div class="l li"><span class="si">        Target memory target;</span></div>
<div class="l li"><span class="si">        for (uint256 idx = 0; idx &lt; gaugeList.length; idx++) {</span></div>
<div class="l li"><span class="si">            target = s_targets[gaugeList[idx]];</span></div>
<div class="l lc d9"><span class="sc">            </span><span class="sc2">IChildChainGauge</span><span class="sc"> gauge = </span><span class="sc2">IChildChainGauge</span><span class="sc">(gaugeList[idx]);</span></div>
<div class="l li"></div>
<div class="l li"><span class="si">            uint256 period_finish = gauge.reward_data(tokenAddress).period_finish;</span></div>
<div class="l li"></div>
<div class="l li"><span class="si">            if (</span></div>
<div class="l li"><span class="si">                target.lastInjectionTimeStamp + minWaitPeriod &lt;= block.timestamp &amp;&amp;</span></div>
<div class="l li"><span class="si">                (period_finish &lt;= block.timestamp) &amp;&amp;</span></div>
<div class="l li"><span class="si">                balance &gt;= target.amountPerPeriod &amp;&amp;</span></div>
<div class="l li"><span class="si">                target.periodNumber &lt; target.maxPeriods &amp;&amp;</span></div>
<div class="l li"><span class="si">                gauge.reward_data(tokenAddress).distributor == address(this)</span></div>
<div class="l li"><span class="si">            ) {</span></div>
<div class="l li"><span class="si">                ready[count] = gaugeList[idx];</span></div>
<div class="l li"><span class="si">                count++;</span></div>
<div class="l li"><span class="si">                balance -= target.amountPerPeriod;</span></div>
<div class="l li"><span class="si">            }</span></div>
<div class="l li"><span class="si">        }</span></div>
<div class="l li"><span class="si">        if (count != gaugeList.length) {</span></div>
<div class="l li"><span class="si">            // ready is a list large enough to hold all possible gauges</span></div>
<div class="l li"><span class="si">            // count is the number of ready gauges that were inserted into ready</span></div>
<div class="l li"><span class="si">            // this assembly shrinks ready to length count such that it removes empty elements</span></div>
<div class="l li"><span class="si">            assembly {</span></div>
<div class="l li"><span class="si">                mstore(ready, count)</span></div>
<div class="l li"><span class="si">            }</span></div>
<div class="l li"><span class="si">        }</span></div>
<div class="l li"><span class="si">        return ready;</span></div>
<div class="l li"><span class="si">    }</span></div>
<div class="l li"></div>
<div class="l li"><span class="si">    /**</span></div>
<div class="l li"><span class="si">   * @notice Injects funds into the gauges provided</span></div>
<div class="l li"><span class="si">   * @param ready the list of gauges to fund (addresses must be pre-approved)</span></div>
<div class="l li"><span class="si">   */</span></div>
<div class="l li"><span class="si">    function _injectFunds(address[] memory ready) internal whenNotPaused {</span></div>
<div class="l la d10"><span class="sa">        uint256 minWaitPeriodSeconds = s_minWaitPeriodSeconds;</span></div>
<div class="l li"><span class="si">        address tokenAddress = s_injectTokenAddress;</span></div>
<div class="l li"><span class="si">        IERC20 token = IERC20(tokenAddress);</span></div>
<div class="l li"><span class="si">        uint256 balance = token.balanceOf(address(this));</span></div>
<div class="l li"><span class="si">        Target memory target;</span></div>
<div class="l li"></div>
<div class="l li"><span class="si">        for (uint256 idx = 0; idx &lt; ready.length; idx++) {</span></div>
<div class="l li"><span class="si">            target = s_targets[ready[idx]];</span></div>
<div class="l lc d11"><span class="sc">            </span><span class="sc2">IChildChainGauge</span><span class="sc"> gauge = </span><span class="sc2">IChildChainGauge</span><span class="sc">(ready[idx]);</span></div>
<div class="l li"><span class="si">            uint256 period_finish = gauge.reward_data(tokenAddress).period_finish;</span></div>
<div class="l li"></div>
<div class="l li"><span class="si">            if (</span></div>
<div class="l lc d12"><span class="sc">                target.lastInjectionTimeStamp + s_minWaitPeriodSeconds &lt;= </span><span class="sa">block.timestamp &amp;&amp;</span></div>
<div class="l lc d12"></div>
<div class="l li"><span class="si">                period_finish &lt;= block.timestamp &amp;&amp;</span></div>
<div class="l li"><span class="si">                balance &gt;= target.amountPerPeriod &amp;&amp;</span></div>
<div class="l li"><span class="si">                target.periodNumber &lt; target.maxPeriods &amp;&amp;</span></div>
<div class="l li"><span class="si">                target.isActive == true</span></div>
<div class="l li"><span class="si">            ) {</span></div>
<div class="l lg"></div>
<div class="l li"><span class="si">                SafeERC20.safeApprove(token, ready[idx], target.amountPerPeriod);</span></div>
<div class="l li"></div>
<div class="l lc d13"><span class="sc">                try </span><span class="sa">gauge.deposit_reward_token(tokenAddress, uint256(target.amountPerPeriod)) {</span></div>
<div class="l lc d13"></div>
<div class="l lc d13"></div>
<div class="l lc d13"></div>
<div class="l lc d13"></div>
<div class="l lc d13"></div>
<div class="l lc d13"><span class="sc">                    s_targets[ready[idx]].lastInjectionTimeStamp = uint56(</span><span class="sa">block.timestamp);</span></div>
<div class="l lc d13"></div>
<div class="l lc d13"></div>
<div class="l li"><span class="si">                    s_targets[ready[idx]].periodNumber++;</span></div>
<div class="l lc d14"><span class="sc">                    emit EmissionsInjection(</span><span class="sa">ready[idx], tokenAddress, target.amountPerPeriod);</span></div>
<div class="l lc d14"></div>
<div class="l lc d14"></div>
<div class="l lc d14"></div>
<div class="l lc d14"></div>
<div class="l li"><span class="si">                } catch {</span></div>
<div class="l li"><span class="si">                    revert RewardTokenError();</span></div>
<div class="l li"><span class="si">                }</span></div>
<div class="l li"><span class="si">            }</span></div>
<div class="l li"><span class="si">        }</span></div>
<div class="l li"><span class="si">    }</span></div>
<div class="l li"></div>
<div class="l li"><span class="si">    /**</span></div>
<div class="l li"><span class="si"> * * @notice This is to allow the owner to manually trigger an injection of funds in place of the keeper</span></div>
<div class="l li"><span class="si">   * @notice without abi encoding the gauge list</span></div>
<div class="l li"><span class="si">   * @param gauges array of gauges to inject tokens to</span></div>
<div class="l li"><span class="si">   */</span></div>
<div class="l li"><span class="si">    function injectFunds(address[] memory gauges) external onlyOwner {</span></div>
<div class="l li"><span class="si">        _injectFunds(gauges);</span></div>
<div class="l li"><span class="si">    }</span></div>
<div class="l li"></div>
<div class="l li"><span class="si">    /**</span></div>
<div class="l li"><span class="si">   * @notice Get list of addresses that are ready for new token injections and return keeper-compatible payload</span></div>
<div class="l li"><span class="si">   * @notice calldata required by the chainlink interface but not used in this case, use 0x</span></div>
<div class="l li"><span class="si">   * @return upkeepNeeded signals if upkeep is needed</span></div>
<div class="l li"><span class="si">   * @return performData is an abi encoded list of addresses that need funds</span></div>
<div class="l li"><span class="si">   */</span></div>
<div class="l lc d15"><span class="sc">    function checkUpkeep(</span><span class="sa">bytes calldata)</span></div>
<div class="l lc d15"></div>
<div class="l lc d15"></div>
<div class="l li"><span class="si">    external</span></div>
<div class="l li"><span class="si">    view</span></div>
<div class="l li"><span class="si">    override</span></div>
<div class="l li"><span class="si">    whenNotPaused</span></div>
<div class="l li"><span class="si">    returns (bool upkeepNeeded, bytes memory performData)</span></div>
<div class="l li"><span class="si">    {</span></div>
<div class="l li"><span class="si">        address[] memory ready = getReadyGauges();</span></div>
<div class="l li"><span class="si">        upkeepNeeded = ready.length &gt; 0;</span></div>
<div class="l li"><span class="si">        performData = abi.encode(ready);</span></div>
<div class="l li"><span class="si">        return (upkeepNeeded, performData);</span></div>
<div class="l li"><span class="si">    }</span></div>
<div class="l li"></div>
<div class="l li"><span class="si">    /**</span></div>
<div class="l li"><span class="si">   * @notice Called by keeper to send funds to underfunded addresses</span></div>
<div class="l li"><span class="si">   * @param performData The abi encoded list of addresses to fund</span></div>
<div class="l li"><span class="si">   */</span></div>
<div class="l lc d16"><span class="sc">    function performUpkeep(</span><span class="sa">bytes calldata performData) external override onlyKeeperRegistry whenNotPaused {</span></div>
<div class="l lc d16"></div>
<div class="l lc d16"></div>
<div class="l li"><span class="si">        address[] memory needsFunding = abi.decode(performData, (address[]));</span></div>
<div class="l li"><span class="si">        _injectFunds(needsFunding);</span></div>
<div class="l li"><span class="si">        emit PerformedUpkeep(needsFunding);</span></div>
<div class="l li"><span class="si">    }</span></div>
<div class="l li"></div>
<div class="l li"><span class="si">    /**</span></div>
<div class="l li"><span class="si">   * @notice Withdraws the contract balance</span></div>
<div class="l li"><span class="si">   */</span></div>
<div class="l li"><span class="si">    function withdrawGasToken() external onlyOwner {</span></div>
<div class="l li"><span class="si">        address payable recipient = payable(owner());</span></div>
<div class="l li"><span class="si">        if (recipient == address(0)) {</span></div>
<div class="l li"><span class="si">            revert ZeroAddress();</span></div>
<div class="l li"><span class="si">        }</span></div>
<div class="l li"><span class="si">        uint256 amount = address(this).balance;</span></div>
<div class="l li"><span class="si">        recipient.transfer(amount);</span></div>
<div class="l li"><span class="si">        emit GasTokenWithdrawn(amount, recipient);</span></div>
<div class="l li"><span class="si">    }</span></div>
<div class="l li"></div>
<div class="l li"><span class="si">    /**</span></div>
<div class="l li"><span class="si">   * @notice Sweep the full contract's balance for a given ERC-20 token</span></div>
<div class="l li"><span class="si">   * @param token The ERC-20 token which needs to be swept</span></div>
<div class="l li"><span class="si">   */</span></div>
<div class="l li"><span class="si">    function sweep(address token) external onlyOwner {</span></div>
<div class="l li"><span class="si">        uint256 balance = IERC20(token).balanceOf(address(this));</span></div>
<div class="l li"><span class="si">        SafeERC20.safeTransfer(IERC20(token), owner(), balance);</span></div>
<div class="l li"><span class="si">        emit ERC20Swept(token, owner(), balance);</span></div>
<div class="l li"><span class="si">    }</span></div>
<div class="l li"></div>
<div class="l lg"></div>
<div class="l lg"></div>
<div class="l li"><span class="si">    /**</span></div>
<div class="l li"><span class="si">   * @notice Set distributor from the injector back to the owner.</span></div>
<div class="l li"><span class="si">   * @notice You will have to call set_reward_distributor back to the injector FROM the current distributor if you wish to continue using the injector</span></div>
<div class="l li"><span class="si">   * @notice be aware that the only addresses able to call set_reward_distributor are the current distributor and balancer governance authorized accounts (the LM multisig)</span></div>
<div class="l li"><span class="si">   * @param gauge The Gauge to set distributor for</span></div>
<div class="l li"><span class="si">   * @param reward_token Token you are setting the distributor for</span></div>
<div class="l li"><span class="si">   */</span></div>
<div class="l lc d17"><span class="sc">    function setDistributorToOwner(</span><span class="sa">address gauge, address reward_token) external onlyOwner {</span></div>
<div class="l lc d17"></div>
<div class="l lc d17"></div>
<div class="l lc d17"></div>
<div class="l lc d17"><span class="sc">        </span><span class="sc2">IChildChainGauge</span><span class="sc">(gauge).set_reward_distributor(reward_token, msg.sender);</span></div>
<div class="l li"><span class="si">    }</span></div>
<div class="l li"></div>
<div class="l li"><span class="si">    /**</span></div>
<div class="l li"><span class="si">   * @notice Manually deposit an amount of tokens to the gauge</span></div>
<div class="l li"><span class="si">   * @param gauge The Gauge to set distributor to injector owner</span></div>
<div class="l li"><span class="si">   * @param reward_token Reward token you are seeding</span></div>
<div class="l li"><span class="si">   * @param amount Amount to deposit</span></div>
<div class="l li"><span class="si">   */</span></div>
<div class="l lc d18"><span class="sc">    function manualDeposit(</span><span class="sa">address gauge, address reward_token, uint256 amount) external onlyOwner {</span></div>
<div class="l lc d18"></div>
<div class="l lc d18"></div>
<div class="l lc d18"></div>
<div class="l lc d18"></div>
<div class="l lc d18"><span class="sc">        </span><span class="sc2">IChildChainGauge</span><span class="sc"> gaugeContract = </span><span class="sc2">IChildChainGauge</span><span class="sc">(gauge);</span></div>
<div class="l li"><span class="si">        IERC20 token = IERC20(reward_token);</span></div>
<div class="l li"><span class="si">        SafeERC20.safeApprove(token, gauge, amount);</span></div>
<div class="l li"><span class="si">        gaugeContract.deposit_reward_token(reward_token, amount);</span></div>
<div class="l li"><span class="si">        emit EmissionsInjection(gauge, reward_token, amount);</span></div>
<div class="l li"><span class="si">    }</span></div>
<div class="l li"></div>
<div class="l li"><span class="si">    /**</span></div>
<div class="l li"><span class="si">   * @notice Sets the keeper registry address</span></div>
<div class="l li"><span class="si">   */</span></div>
<div class="l lc d19"><span class="sc">    function setKeeperRegistryAddress(</span><span class="sa">address keeperRegistryAddress) public onlyOwner {</span></div>
<div class="l lc d19"></div>
<div class="l lc d19"></div>
<div class="l li"><span class="si">        s_keeperRegistryAddress = keeperRegistryAddress;</span></div>
<div class="l lc d20"><span class="sc">        emit KeeperRegistryAddressUpdated(</span><span class="sa">s_keeperRegistryAddress, keeperRegistryAddress);</span></div>
<div class="l lc d20"></div>
<div class="l lc d20"></div>
<div class="l lc d20"></div>
<div class="l li"><span class="si">    }</span></div>
<div class="l li"></div>
<div class="l li"><span class="si">    /**</span></div>
<div class="l li"><span class="si">   * @notice Sets the minimum wait period (in seconds) for addresses between injections</span></div>
<div class="l li"><span class="si">   */</span></div>
<div class="l li"><span class="si">    function setMinWaitPeriodSeconds(uint256 period) public onlyOwner {</span></div>
<div class="l li"><span class="si">        s_minWaitPeriodSeconds = period;</span></div>
<div class="l li"><span class="si">        emit MinWaitPeriodUpdated(s_minWaitPeriodSeconds, period);</span></div>
<div class="l li"><span class="si">    }</span></div>
<div class="l li"></div>
<div class="l li"><span class="si">    /**</span></div>
<div class="l li"><span class="si">   * @notice Gets the keeper registry address</span></div>
<div class="l li"><span class="si">   */</span></div>
<div class="l lc d21"><span class="sc">    function getKeeperRegistryAddress() </span><span class="sa">external view returns (address keeperRegistryAddress) {</span></div>
<div class="l lc d21"></div>
<div class="l lc d21"></div>
<div class="l lc d21"></div>
<div class="l lc d21"></div>
<div class="l li"><span class="si">        return s_keeperRegistryAddress;</span></div>
<div class="l li"><span class="si">    }</span></div>
<div class="l li"></div>
<div class="l li"><span class="si">    /**</span></div>
<div class="l li"><span class="si">   * @notice Gets the minimum wait period</span></div>
<div class="l li"><span class="si">   */</span></div>
<div class="l li"><span class="si">    function getMinWaitPeriodSeconds() external view returns (uint256) {</span></div>
<div class="l li"><span class="si">        return s_minWaitPeriodSeconds;</span></div>
<div class="l li"><span class="si">    }</span></div>
<div class="l li"></div>
<div class="l li"><span class="si">    /**</span></div>
<div class="l li"><span class="si">   * @notice Gets the list of addresses on the in the current configuration.</span></div>
<div class="l li"><span class="si">   */</span></div>
<div class="l li"><span class="si">    function getWatchList() external view returns (address[] memory) {</span></div>
<div class="l li"><span class="si">        return s_gaugeList;</span></div>
<div class="l li"><span class="si">    }</span></div>
<div class="l li"></div>
<div class="l li"><span class="si">    /**</span></div>
<div class="l li"><span class="si">   * @notice Sets the address of the ERC20 token this contract should handle</span></div>
<div class="l li"><span class="si">   */</span></div>
<div class="l li"><span class="si">    function setInjectTokenAddress(address ERC20token) public onlyOwner {</span></div>
<div class="l li"><span class="si">        s_injectTokenAddress = ERC20token;</span></div>
<div class="l li"><span class="si">        emit SetHandlingToken(ERC20token);</span></div>
<div class="l li"><span class="si">    }</span></div>
<div class="l li"><span class="si">    /**</span></div>
<div class="l li"><span class="si">   * @notice Gets the token this injector is operating on</span></div>
<div class="l li"><span class="si">   */</span></div>
<div class="l li"></div>
<div class="l li"><span class="si">    function getInjectTokenAddress() external view returns (address){</span></div>
<div class="l li"><span class="si">        return s_injectTokenAddress;</span></div>
<div class="l li"><span class="si">    }</span></div>
<div class="l li"><span class="si">    /**</span></div>
<div class="l li"><span class="si">   * @notice Gets configuration information for an address on the gaugelist</span></div>
<div class="l li"><span class="si">   * @param targetAddress return Target struct for a given gauge according to the current scheduled distributions</span></div>
<div class="l li"><span class="si">   */</span></div>
<div class="l li"></div>
<div class="l lc d22"><span class="sc">    function getAccountInfo(</span><span class="sa">address targetAddress)</span></div>
<div class="l lc d22"></div>
<div class="l lc d22"></div>
<div class="l li"><span class="si">    external</span></div>
<div class="l li"><span class="si">    view</span></div>
<div class="l li"><span class="si">    returns (</span></div>
<div class="l li"><span class="si">        uint256 amountPerPeriod,</span></div>
<div class="l li"><span class="si">        bool isActive,</span></div>
<div class="l li"><span class="si">        uint8 maxPeriods,</span></div>
<div class="l li"><span class="si">        uint8 periodNumber,</span></div>
<div class="l li"><span class="si">        uint56 lastInjectionTimeStamp</span></div>
<div class="l li"><span class="si">    )</span></div>
<div class="l li"><span class="si">    {</span></div>
<div class="l li"><span class="si">        Target memory target = s_targets[targetAddress];</span></div>
<div class="l lc d23"><span class="sc">        return (</span><span class="sa">target.amountPerPeriod, target.isActive, target.maxPeriods, target.periodNumber, target.lastInjectionTimeStamp);</span></div>
<div class="l lc d23"></div>
<div class="l lc d23"></div>
<div class="l lc d23"></div>
<div class="l lc d23"></div>
<div class="l lc d23"></div>
<div class="l lc d23"></div>
<div class="l li"><span class="si">    }</span></div>
<div class="l li"></div>
<div class="l li"><span class="si">    /**</span></div>
<div class="l li"><span class="si">   * @notice Pauses the contract, which prevents executing performUpkeep</span></div>
<div class="l li"><span class="si">   */</span></div>
<div class="l li"><span class="si">    function pause() external onlyOwner {</span></div>
<div class="l li"><span class="si">        _pause();</span></div>
<div class="l li"><span class="si">    }</span></div>
<div class="l li"></div>
<div class="l li"><span class="si">    /**</span></div>
<div class="l li"><span class="si">   * @notice Unpauses the contract</span></div>
<div class="l li"><span class="si">   */</span></div>
<div class="l li"><span class="si">    function unpause() external onlyOwner {</span></div>
<div class="l li"><span class="si">        _unpause();</span></div>
<div class="l li"><span class="si">    }</span></div>
<div class="l li"></div>
<div class="l li"><span class="si">    /**</span></div>
<div class="l li"><span class="si">   * @notice takes in a list of addresses and reverts if there is a duplicate</span></div>
<div class="l li"><span class="si">   */</span></div>
<div class="l li"><span class="si">    function revertOnDuplicate(address[] memory list) internal pure {</span></div>
<div class="l li"><span class="si">        uint256 length = list.length;</span></div>
<div class="l li"><span class="si">        if (length == 0) {</span></div>
<div class="l li"><span class="si">            return;</span></div>
<div class="l li"><span class="si">        }</span></div>
<div class="l li"><span class="si">        for (uint256 i = 0; i &lt; length - 1; i++) {</span></div>
<div class="l li"><span class="si">            for (uint256 j = i + 1; j &lt; length; j++) {</span></div>
<div class="l li"><span class="si">                if (list[i] == list[j]) {</span></div>
<div class="l li"><span class="si">                    revert DuplicateAddress(list[i]);</span></div>
<div class="l li"><span class="si">                }</span></div>
<div class="l li"><span class="si">            }</span></div>
<div class="l li"><span class="si">        }</span></div>
<div class="l li"><span class="si">        // No duplicates found</span></div>
<div class="l li"><span class="si">    }</span></div>
<div class="l li"></div>
<div class="l li"><span class="si">    modifier onlyKeeperRegistry() {</span></div>
<div class="l li"><span class="si">        if (msg.sender != s_keeperRegistryAddress) {</span></div>
<div class="l li"><span class="si">            revert OnlyKeeperRegistry(msg.sender);</span></div>
<div class="l li"><span class="si">        }</span></div>
<div class="l li"><span class="si">        _;</span></div>
<div class="l li"><span class="si">    }</span></div>
<div class="l li"><span class="si">}</span></div>
<div class="l li"></div>

                            </td>
                        </tr>
                    </table>
                </div>
            </div>
        </div>

        <div id="inspector" style="display: none;">
            <div class="left line">
                <table id="inspectorLeft" class="inspectorLine">
                    <tr>
                        <td class="diffBar" style="display: none;"></td>
                        <td class="nums">
                            <div class="num"></div>
                        </td>
                        <td class="content">
                            <div id="inspectorLeftContent"></div>
                        </td>
                    </tr>
                </table>
            </div>
            <div class="right line">
                <table id="inspectorRight" class="inspectorLine">
                    <tr>
                        <td class="diffBar" style="display: none;"></td>
                        <td class="nums">
                            <div class="num"></div>
                        </td>
                        <td class="content">
                            <div id="inspectorRightContent"></div>
                        </td>
                    </tr>
                </table>
            </div>
        </div>

        <div id="legend">
            <div id="numDiffs"><b>23 differences</b>: 82 lines, 86 inline differences in 80 changed lines</div><div id="colors"><div class="sa" title="Added lines: 1, inline additions in changed lines: 19">Added(1,19)</div><div class="sd" title="Deleted lines: 1, inline deletions in changed lines: 55">Deleted(1,55)</div><div class="sc" title="Changed lines: 80">Changed(80)</div><div class="sc2" title="Inline changes in changed lines: 12">Changed in changed(12)</div><div class="sig" title="Ignored lines and line parts">Ignored</div></div>
        </div>

        <div id="generated_by">
            Generated on August 6, 2024, 6:35 PM (UTC) by <a href="https://www.prestosoft.com/edp_examdiffpro.asp?ref=diffreport" target="_blank">ExamDiff Pro</a> 15.0.1.2.
        </div>
    </div>
</body>

</html>
